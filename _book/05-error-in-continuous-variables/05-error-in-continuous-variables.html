<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Artifact Corrections for Effect Sizes - 6&nbsp; Classical Measurement Errors</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../06-misclassification/06-misclassification.html" rel="next">
<link href="../04-introduction-to-measurement-error/04-introduction-to-measurement-error.html" rel="prev">
<link href="../figure/favicon_book.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta name="twitter:title" content="Artifact Corrections for Effect Sizes - 6&nbsp; Classical Measurement Errors">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://matthewbjane.quarto.pub/artifact-corrections-for-effect-sizes/05-error-in-continuous-variables/figure/MJB_twitter.jpg">
<meta name="twitter:creator" content="@MatthewBJane">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../04-introduction-to-measurement-error/04-introduction-to-measurement-error.html">Measurement Error</a></li><li class="breadcrumb-item"><a href="../05-error-in-continuous-variables/05-error-in-continuous-variables.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Classical Measurement Errors</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Artifact Corrections for Effect Sizes</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/MatthewBJane/artifact-corrections-for-effect-sizes/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="../Artifact-Corrections-for-Effect-Sizes.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Greetings</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../00-dedication/00-dedication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Dedication</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-definitions/01-definitions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Samples, Random Variables, and Expectations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-effect-sizes/02-effect-sizes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Effect Sizes and Artifacts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-small-samples/03-small-samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Small Samples</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../04-introduction-to-measurement-error/04-introduction-to-measurement-error.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Measurement Error</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05-error-in-continuous-variables/05-error-in-continuous-variables.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Classical Measurement Errors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06-misclassification/06-misclassification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Group Misclassification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07-artificial-dichotomization/07-artificial-dichotomization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Artificial Dichotomization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08-scale-coarseness/08-scale-coarseness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Scale Coarseness</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../09-introduction-to-selection-effects/09-introduction-to-selection-effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Selection Effects</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10-direct-selection/10-direct-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Direct Selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../11-indirect-selection/11-indirect-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Indirect Selection</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../13-artifact-correction-meta-analysis/13-artifact-correction-meta-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Artifact Correction Meta-Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../14-conclusion/14-conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references/references_page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">6.1</span> Introduction</a></li>
  <li><a href="#classical-measurement-error-calibration" id="toc-classical-measurement-error-calibration" class="nav-link" data-scroll-target="#classical-measurement-error-calibration"><span class="header-section-number">6.2</span> Classical Measurement Error Calibration</a></li>
  <li><a href="#sec-true-score-theory" id="toc-sec-true-score-theory" class="nav-link" data-scroll-target="#sec-true-score-theory"><span class="header-section-number">6.3</span> Reliability</a>
  <ul class="collapse">
  <li><a href="#reliability-of-composites" id="toc-reliability-of-composites" class="nav-link" data-scroll-target="#reliability-of-composites"><span class="header-section-number">6.3.1</span> Reliability of Composites</a></li>
  <li><a href="#coefficient-of-stability" id="toc-coefficient-of-stability" class="nav-link" data-scroll-target="#coefficient-of-stability"><span class="header-section-number">6.3.2</span> Coefficient of Stability</a></li>
  <li><a href="#alpha-coefficient-of-stability" id="toc-alpha-coefficient-of-stability" class="nav-link" data-scroll-target="#alpha-coefficient-of-stability"><span class="header-section-number">6.3.3</span> Alpha Coefficient of Stability</a></li>
  </ul></li>
  <li><a href="#sec-correcting-correlations-me" id="toc-sec-correcting-correlations-me" class="nav-link" data-scroll-target="#sec-correcting-correlations-me"><span class="header-section-number">6.4</span> Correcting Correlations</a>
  <ul class="collapse">
  <li><a href="#defining-the-target-correlation" id="toc-defining-the-target-correlation" class="nav-link" data-scroll-target="#defining-the-target-correlation"><span class="header-section-number">6.4.1</span> Defining the Target Correlation</a></li>
  <li><a href="#sec-r-corr" id="toc-sec-r-corr" class="nav-link" data-scroll-target="#sec-r-corr"><span class="header-section-number">6.4.2</span> Artifact Correction for Correlations</a></li>
  <li><a href="#differential-measurement-error" id="toc-differential-measurement-error" class="nav-link" data-scroll-target="#differential-measurement-error"><span class="header-section-number">6.4.3</span> Differential Measurement Error</a></li>
  </ul></li>
  <li><a href="#correcting-standardized-mean-differences-smd" id="toc-correcting-standardized-mean-differences-smd" class="nav-link" data-scroll-target="#correcting-standardized-mean-differences-smd"><span class="header-section-number">6.5</span> Correcting Standardized Mean Differences (SMD)</a>
  <ul class="collapse">
  <li><a href="#defining-the-target-smd" id="toc-defining-the-target-smd" class="nav-link" data-scroll-target="#defining-the-target-smd"><span class="header-section-number">6.5.1</span> Defining the Target SMD</a></li>
  <li><a href="#sec-d-SMD" id="toc-sec-d-SMD" class="nav-link" data-scroll-target="#sec-d-SMD"><span class="header-section-number">6.5.2</span> Artifact Correction for SMDs</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../04-introduction-to-measurement-error/04-introduction-to-measurement-error.html">Measurement Error</a></li><li class="breadcrumb-item"><a href="../05-error-in-continuous-variables/05-error-in-continuous-variables.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Classical Measurement Errors</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Classical Measurement Errors</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">6.1</span> Introduction</h2>
<p>Measurements are often calibrated to their true value such that errors over repeated measurements tend to cancel out. In cases like this, averaging across the outcomes of multiple measurements may provide a more precise value. However, not all measures are created equal, some perform better than others. Ideally, measurement procedures should produce consistent scores upon repeated measurements. This repeatability is referred to as the <em>reliability</em> of a measure. A high quality measure should produce highly reliable scores. This section will review what reliability is in theory, how to estimate reliability, and how to correct effect sizes for measurement error.</p>
</section>
<section id="classical-measurement-error-calibration" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="classical-measurement-error-calibration"><span class="header-section-number">6.2</span> Classical Measurement Error Calibration</h2>
<p>The values of a target random variable are often referred to as true score and can be defined by some real characteristic or quality of an individual that is independent of the measurement procedure (e.g., height of a person), we can consider this a <em>realist</em> approach. However, if the underlying data generating process is unknown, one could opt to define the true score as the expected value of measurement outcomes (e.g., average reaction time over repeated trials), which can be thought of as an <em>operationalist</em> approach. Therefore if we take the operationalist approach, a convenient way to define the true scores for each individual is as follows:</p>
<p><span id="eq-truescore"><span class="math display">\[
X := \mathbb{E}\left[\widetilde{X}\;\middle|\; \mathcal{M}_\ell \right],
\tag{6.1}\]</span></span></p>
<p>Where <span class="math inline">\(\mathcal{M}\)</span> is defined as the <span class="math inline">\(\sigma\)</span>–field generated by the assignment-to-individual function <span class="math inline">\(\ell\)</span>,</p>
<p><span class="math display">\[
\mathcal{M}_\ell = \left\lbrace\ell^{-1}(\psi) \;\middle|\; \psi\in\Psi \right\rbrace \subset \mathcal{F}_{\Omega}
\]</span></p>
<p>where <span class="math inline">\(\psi\in\Psi\)</span> is an individual <span class="math inline">\(\psi\)</span> in the population of interest <span class="math inline">\(\Psi\)</span> and <span class="math inline">\(\mathcal{F}_{\Omega}\)</span> is the <span class="math inline">\(\sigma\)</span>–field over the outcome space <span class="math inline">\(\Omega\)</span>. Put in simpler words, the true score for an individual <span class="math inline">\(\psi\in\Psi\)</span> is defined as the expected value over all possible measurement outcomes for that individual. This is definition of true scores that is typically attributed to Classical Test Theory <span class="citation" data-cites="zimmerman1975">(<a href="../references/references_page.html#ref-zimmerman1975" role="doc-biblioref">Donald W. Zimmerman 1975</a>)</span>. As a consequence, this definition of true scores produces the following properties <span class="citation" data-cites="kroc2020">(<a href="../references/references_page.html#ref-kroc2020" role="doc-biblioref">Kroc and Zumbo 2020</a>)</span>,</p>
<p><span id="eq-properties"><span class="math display">\[\begin{align}
&amp;\mathrm{I.}\;\;\;\sigma_{XE_X}=0 \\[.3em]
&amp;\mathrm{II.}\;\;\;\mathbb{E}\!\left[E_X\right]\!=0
\end{align} \tag{6.2}\]</span></span></p>
<p>where <span class="math inline">\(\sigma_{XE_X}\)</span> is the covariance between the true value <span class="math inline">\(X\)</span> and the associated error <span class="math inline">\(E_X\)</span>. Property <span class="math inline">\(\mathrm{I}\)</span> ensures that there is no correlation between true scores and errors whereas property <span class="math inline">\(\mathrm{II}\)</span> ensures that errors have a mean of zero in the population. A realist approach to measurement posits that <span class="math inline">\(X\)</span> is not defined by the expectation of measurement outcomes, rather it is defined by a measurement <em>independent</em> attribute/characteristic. With this definition of true scores, properties <span class="math inline">\(\mathrm{I}\)</span> and <span class="math inline">\(\mathrm{II}\)</span> are not automatically true. If reasonable, the realist can <em>assume</em> that properties <span class="math inline">\(\mathrm{I}\)</span> and <span class="math inline">\(\mathrm{II}\)</span> are met. If the realist assumes these properties are met, then <a href="#eq-truescore" class="quarto-xref">Equation&nbsp;<span>6.1</span></a> is a necessary consequence of those assumptions. In sum, the important difference between the realist and operationalist is that the properties described in <a href="#eq-properties" class="quarto-xref">Equation&nbsp;<span>6.2</span></a> must be <em>assumed</em> by the realist whereas it is a <em>consequence</em> of the definition of true scores for the operationalist.</p>
<p>Let’s denote a single instance of a measurement outcome with <span class="math inline">\(\widetilde{X}_{\mathsf{m}}:=\widetilde{X}(\omega)\)</span> and a single instance of the true score <span class="math inline">\(X:=X(\omega)\)</span> for some outcome <span class="math inline">\(\omega\in\ell^{-1}(\psi)\)</span> for each individual <span class="math inline">\(\psi\in\Psi\)</span>. The subscript <span class="math inline">\(\mathsf{m}\)</span> indexes the outcomes of a single measurement instance. Since the true score is fixed over all possible measurement outcomes within an individual this index is not needed for <span class="math inline">\(X\)</span>. For a measurement <span class="math inline">\(\mathsf{m}\)</span>, we can relate the true score <span class="math inline">\(X\)</span> and the observed score <span class="math inline">\(\widetilde{X}_\mathsf{m}\)</span> with the following algebraic structure,</p>
<p><span id="eq-ctt"><span class="math display">\[
\widetilde{X}_{\mathsf{m}} = X + E_{X\mathsf{m}}
\tag{6.3}\]</span></span></p>
<p>where the error is defined as <span class="math inline">\(E_{X\mathsf{m}} = \widetilde{X}_{\mathsf{m}} - X\)</span>. Since we have established that the covariance between <span class="math inline">\(X\)</span> and <span class="math inline">\(E_X\)</span> is zero, we can easily parse out the variance of the three components in <a href="#eq-ctt" class="quarto-xref">Equation&nbsp;<span>6.3</span></a>,</p>
<p><span class="math display">\[
\sigma^2_\widetilde{X} = \sigma^2_X + \sigma^2_{E_X}.
\]</span></p>
<p>We can see that the variance of observed scores is a simple summation of the variance of true scores and error which tells us that if the measure was perfect (i.e., no measurement error) than the error variance would be zero and <span class="math inline">\(\sigma^2_\widetilde{X} = \sigma^2_X\)</span>.</p>
</section>
<section id="sec-true-score-theory" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="sec-true-score-theory"><span class="header-section-number">6.3</span> Reliability</h2>
<p>The reliability of <span class="math inline">\(X\)</span> is defined as the variance of true scores over the variance in observed proxy scores <span class="math inline">\(X\)</span> (i.e., an intra-class correlation),</p>
<p><span id="eq-reliability"><span class="math display">\[
\rho_{\widetilde{X}\widetilde{X}'} = \frac{\sigma^2_X}{\sigma^2_\widetilde{X}}= \frac{\sigma^2_X}{\sigma^2_X + \sigma^2_{E_X}}
\tag{6.4}\]</span></span></p>
<p>However we can also express it as the correlation between between two parallel measurements. Strictly parallel measurements have the following four properties <span class="citation" data-cites="haertel2006">(p.&nbsp;69, <a href="../references/references_page.html#ref-haertel2006" role="doc-biblioref">Haertel 2006</a>)</span>:</p>
<ol type="1">
<li>Measurements have identical specifications. That is, each measurement uses the same measurement procedure.</li>
<li>The distribution of observed scores for each measurement are identical: <span class="math inline">\(f_{\widetilde{X}_1} = f_{\widetilde{X}_2} = \dots\)</span></li>
<li>Any set of two measurements are assumed to covary the same as any other set of two measurements: <span class="math inline">\(\sigma_{\widetilde{X}_1 \widetilde{X}_2} = \sigma_{\widetilde{X}_2 \widetilde{X}_3} = \sigma_{\widetilde{X}_1 \widetilde{X}_3} = \ldots\)</span></li>
<li>Each measurement equally covaries with any other variable: <span class="math inline">\(\sigma_{\widetilde{X}_1 Y} = \sigma_{\widetilde{X}_2 Y} = \ldots\)</span></li>
</ol>
<p>These properties will be useful especially when we discuss composite scores. The correlation between parallel measurements can also be expressed by the square of the correlation between observed proxy scores and true scores, <span class="math inline">\(\rho_{X\widetilde{X}}^2\)</span> . To understand why this is the case, note that the covariance between parallel forms of a measure is equivalent to the covariance between observed scores and true scores, <span class="math inline">\(\sigma_{\widetilde{X}X}=\)</span><span class="math inline">\(\sigma_{(\widetilde{X}+E_X)X}=\)</span><span class="math inline">\(\sigma^2_X + \sigma_{XE_X}=\)</span><span class="math inline">\(\sigma^2_X = \sigma_{\widetilde{X}\widetilde{X}'}\)</span> <span class="citation" data-cites="haertel2006">(<a href="../references/references_page.html#ref-haertel2006" role="doc-biblioref">Haertel 2006</a>)</span>,</p>
<p><span id="eq-reliability"><span class="math display">\[
\rho_{\widetilde{X}\widetilde{X}'} = \frac{\sigma_X^2}{\sigma_\widetilde{X}^2} = \frac{\left(\sigma_X^2\right)^2}{\sigma_\widetilde{X}^2 \sigma_X^2}= \frac{\sigma_{\widetilde{X}X}^2}{\sigma^2_\widetilde{X}\sigma^2_X} = \rho^2_{X\widetilde{X}}.
\tag{6.5}\]</span></span></p>
<p>Estimating reliability can easily be done if a researcher has access to parallel measurements as they would simply need to compute the correlation between the two sets of observed scores. This is not always the case however, therefore we will cover different ways of calculating the reliability of a measure depending on the available data</p>
<section id="reliability-of-composites" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="reliability-of-composites"><span class="header-section-number">6.3.1</span> Reliability of Composites</h3>
<p>Composite measurements try to average across multiple <em>sub</em>-measurements (i.e., items, trials, ratings) to obtain a more precise score. Let <span class="math inline">\(\mathsf{\tilde{x}}_q\)</span> denote the outcome of sub-measurement <span class="math inline">\(q\)</span> such that,</p>
<p><span id="eq-ctt-sub"><span class="math display">\[
\mathsf{\tilde{x}}_q= \mathsf{x}_q + \mathsf{e}^\mathsf{x}_q
\tag{6.6}\]</span></span></p>
<p>Where <span class="math inline">\(q=1{...}\kappa\)</span> indexes the sub-measurement, <span class="math inline">\(\mathsf{x}_q\)</span> denotes the true score and <span class="math inline">\(\mathsf{e}^\mathsf{x}_q\)</span> denotes the error of the <span class="math inline">\(q\)</span>th sub-measurement. Each of the three components in <a href="#eq-ctt-sub" class="quarto-xref">Equation&nbsp;<span>6.6</span></a> are defined similarly to <a href="#eq-ctt" class="quarto-xref">Equation&nbsp;<span>6.3</span></a> with the exception that the true score (the expected value) is allowed to vary between sub-measurements. A composite score reduces measurement error by combining multiple sub-measurements together. Therefore, measurement <span class="math inline">\(\mathsf{m}\)</span> of some individual <span class="math inline">\(\psi\in\Psi\)</span> is a weighted average of sub-measurement outcomes,</p>
<p><span id="eq-sum-score"><span class="math display">\[
\widetilde{X}_\mathsf{m} = \frac{\sum^q_{1...\kappa}\mathsf{w}_q\mathsf{\tilde{x}}_q}{\sum^q_{1...\kappa}\mathsf{w}_q}
\tag{6.7}\]</span></span></p>
<p>Clearly, if the weights are uniform <span class="math inline">\(\mathsf{w}_1=\mathsf{w}_2=...=\mathsf{w}_\kappa\)</span>, then the composite becomes an unit-weighted average. Note that the weighted average of true sub-scores <span class="math inline">\(\mathsf{x}_q\)</span> is equal to the true score <span class="math inline">\(X\)</span>.</p>
<p>The estimating the reliability of the composite <span class="math inline">\(\widetilde{X}\)</span> is the primary purpose of this section. Before we can do that, we have to acknowledge that certain reliability coefficients, assumptions must be made that are analogous to the four assumptions about strictly parallel measurements. Depending on the reliability coefficient, not all of four of the assumptions of strictly parallel sub-measurements have to be met. Instead, we can talk about three conditions that hold different assumptions <span class="citation" data-cites="haertel2006">(<a href="../references/references_page.html#ref-haertel2006" role="doc-biblioref">Haertel 2006, 71</a>)</span>:</p>
<ul>
<li><p><strong>Tau-equivalence</strong>: this is the strongest of the three conditions where true scores are fixed across sub-measurements <span class="math inline">\(\mathsf{x}_{1} = \mathsf{x}_{2} = \dots\)</span> as well as true variances are equivalent <span class="math inline">\(\sigma^2_\mathsf{x_1} = \sigma^2_\mathsf{x_2} = \dots\)</span>. However, the variance of observed scores are allowed to vary between sub-measurements, in other words, the errors .</p></li>
<li><p><strong>Essential Tau-equivalence</strong>: this condition is looser than tau-equivalence as it allows the true score to vary between sub-measurements. Each sub-measurement is related to each other by an additive constant such that, <span class="math inline">\(\mathsf{x}_{1} = \mathsf{x}_{2} + \mathsf{c}_{12}\)</span> (note that this constant is the same for all individuals). The true variances still must be equivalent <span class="math inline">\(\sigma^2_\mathsf{x_1} = \sigma^2_\mathsf{x_2}\)</span>. However, the variance of observed scores are still allowed to vary between sub-measurements.</p></li>
<li><p><strong>Congeneric Measurements</strong>: this is the loosest of the three conditions. Congeneric measurements do not require that true variances are equal between sub-measurements are equal because now it relates the true scores between measurements as a linear function, <span class="math inline">\(\mathsf{x}_{1} = \mathsf{b}_{12}\mathsf{x}_{2} + \mathsf{c}_{12}\)</span>. This allows the mean and variance of the true scores to differ across sub-measurements.</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div id="fig-reliability" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-reliability-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05-error-in-continuous-variables_files/figure-html/fig-reliability-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-reliability-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.1: Figures showing the observed scores upon 10 sub-measurements and the composite observed score (dark point + error bars). The left panel shows a score with low reliability and the right shows an observed score with high reliability.
</figcaption>
</figure>
</div>
</div>
</div>
<section id="coefficient-alpha" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="coefficient-alpha">Coefficient Alpha</h4>
<p>The most common reliability coefficient in psychological and social sciences is Coefficient alpha <span class="citation" data-cites="cronbach1951">(also referred to as Cronbach’s Alpha, <a href="../references/references_page.html#ref-cronbach1951" role="doc-biblioref">Cronbach 1951</a>)</span>. Coefficient alpha assumes the sub-measurements meet the conditions described by essential tau-equivalence. If the sub-measurements are not essentially tau-equivalent than Coefficient alpha is a lower bound (something to keep in mind when we are correcting effect sizes). The equation for the unstandardized version of Coefficient alpha is,</p>
<p><span id="eq-alpha-u"><span class="math display">\[
\rho_{\widetilde{X}\widetilde{X}'} = \frac{\kappa \,\bar{\sigma}_{\mathsf{\tilde{x}}_q\mathsf{\tilde{x}}_j}}
{\bar{\sigma}^2_{\mathsf{\tilde{x}}_q}+
(\kappa-1)\bar{\sigma}_{\mathsf{\tilde{x}}_q\mathsf{\tilde{x}}_j}}\, , \;\;\;\;q\neq j.
\tag{6.8}\]</span></span></p>
<p>where <span class="math inline">\(\bar{\sigma}_{\mathsf{x}_q\mathsf{x}_j}\)</span> is the average of the off-diagonal elements of the covariance matrix (i.e., <span class="math inline">\(q\neq j\)</span>) and <span class="math inline">\(\bar{\sigma}^2_{\mathsf{x}_q}\)</span> is the average variance in observed scores across <span class="math inline">\(\kappa\)</span> sub-measurements. Since covariance matrices are not always available to calculate may be unavailable, so instead we can compute a standardized alpha coefficient using the correlation matrix <span class="citation" data-cites="spearman1910 brown1910">(<a href="../references/references_page.html#ref-spearman1910" role="doc-biblioref">Charles Spearman 1910</a>; <a href="../references/references_page.html#ref-brown1910" role="doc-biblioref">Brown 1910</a>)</span>,</p>
<p><span id="eq-alpha-s"><span class="math display">\[
\rho_{\widetilde{X}\widetilde{X}'} = \frac{\kappa \,\bar{\rho}_{\mathsf{\tilde{x}}_q\mathsf{\tilde{x}}_j}}
{1+
(\kappa-1)\bar{\rho}_{\mathsf{\tilde{x}}_q\mathsf{\tilde{x}}_j}}\, , \;\;\;\;q\neq j.
\tag{6.9}\]</span></span></p>
<p>Another situation where standardized alpha is preferrable is sub-measurements were on completely different scales and therefore scores had to be standardized before combining them together. The standardized coefficient alpha assumes The equation can simplify further if you have only two measurements. For the unstandardized variant of coefficient alpha, if there are only two sub-measurements than it reduces to a <em>split-half</em> reliability <span class="citation" data-cites="rulon1939">(<a href="../references/references_page.html#ref-rulon1939" role="doc-biblioref">Rulon 1939</a>, eq. 53)</span>,</p>
<p><span id="eq-sh-u"><span class="math display">\[
\rho_{\widetilde{X}\widetilde{X}'} = \frac{4\,\bar{\sigma}_{\mathsf{\tilde{x}}_1\mathsf{\tilde{x}}_2}}{\sigma^2_{\mathsf{\tilde{x}}_1} + \sigma^2_{\mathsf{\tilde{x}}_2} + 2\bar{\sigma}_{\mathsf{\tilde{x}}_1\mathsf{\tilde{x}}_2}}.
\tag{6.10}\]</span></span> Whereas the standardized split-hald formula is even simpler,</p>
<p><span id="eq-sh-s"><span class="math display">\[
\rho_{\widetilde{X}\widetilde{X}'} = \frac{2\,\bar{\rho}_{\mathsf{\tilde{x}}_1\mathsf{\tilde{x}}_2}}{1 + \bar{\rho}_{\mathsf{\tilde{x}}_1\mathsf{\tilde{x}}_2}}.
\tag{6.11}\]</span></span></p>
<p>It is worth noting that the Kuder-Richardson-20 reliability is identical to <a href="#eq-alpha-u" class="quarto-xref">Equation&nbsp;<span>6.8</span></a> with the difference being that the observed sub-scores are Bernoulli random variables (i.e., 0/1, correct/incorrect, yes/no valued), which simplifies the formula <span class="citation" data-cites="kuder1937">(see <a href="../references/references_page.html#ref-kuder1937" role="doc-biblioref">Kuder and Richardson 1937</a>)</span></p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reliability of Agreeableness Mean-Score
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>psych</code> package <span class="citation" data-cites="psych">(<a href="../references/references_page.html#ref-psych" role="doc-biblioref">William Revelle 2023</a>)</span> contains data on the big 5 personality traits from a large sample of 2800 individuals. We can try to calculate the reliability coefficient for the Agreeableness scale from the five question items (each item is a 6-point scale). Let’s first load in the data set and then clean up the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psychmeta)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(missRanger)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Clean data</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> bfi <span class="sc">|&gt;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select only relevant columns</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(A1,A2,A3,A4,A5) <span class="sc">|&gt;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># reverse scored items</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">A1 =</span> <span class="dv">6</span><span class="sc">-</span>A1) <span class="sc">|&gt;</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># impute</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">imputeUnivariate</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using the <code>alpha</code> function from the <code>psych</code> package we can compute the standardized and unstandardized Coefficient Alpha. Note that the argument <code>check.keys=TRUE</code> allows the function to automatically flip reversed scored items, however it is best to first flip the items to the desired direction instead of allowing the <code>alpha()</code> function to try to detect reversed items.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute reliability</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>reliability <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">alpha</span>(df)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># only display the total scale reliabilities</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>reliability<span class="sc">$</span>total[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> raw_alpha std.alpha
 0.6980189 0.7077484</code></pre>
</div>
</div>
<p>The reliability for the sample is estimated to be <span class="math inline">\(\rho_{\widetilde{X}\widetilde{X'}}=.70\)</span> for the unstandardized (raw) alpha coefficient and <span class="math inline">\(\rho_{\widetilde{X}\widetilde{X'}}=.71\)</span> for the standardized alpha coefficient.</p>
<p>If the raw data is not available to us but the following correlation matrix table (<a href="#tbl-corr-matrix-uc" class="quarto-xref">Table&nbsp;<span>6.1</span></a>) is we can use the standardized formula of alpha to calculate the reliability.</p>
<div class="cell">
<div id="tbl-corr-matrix-uc" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-corr-matrix-uc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.1: item correlation matrix
</figcaption>
<div aria-describedby="tbl-corr-matrix-uc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_jbxxis6ajiho0wn241hy</title>
    <style>
.table td.tinytable_css_9au0jpln13a7y8k8ahwu, .table th.tinytable_css_9au0jpln13a7y8k8ahwu {    border-bottom: solid 0.1em #d3d8dc; }
.table td.tinytable_css_xhgz86oyksklwoz24p9s, .table th.tinytable_css_xhgz86oyksklwoz24p9s {    color: white; background-color: #d74ea2ff; }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-borderless" id="tinytable_jbxxis6ajiho0wn241hy" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Item</th>
                <th scope="col">A1</th>
                <th scope="col">A2</th>
                <th scope="col">A3</th>
                <th scope="col">A4</th>
                <th scope="col">A5</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>A1</td>
                  <td>1.00</td>
                  <td>0.33</td>
                  <td>0.26</td>
                  <td>0.14</td>
                  <td>0.18</td>
                </tr>
                <tr>
                  <td>A2</td>
                  <td>0.33</td>
                  <td>1.00</td>
                  <td>0.47</td>
                  <td>0.33</td>
                  <td>0.38</td>
                </tr>
                <tr>
                  <td>A3</td>
                  <td>0.26</td>
                  <td>0.47</td>
                  <td>1.00</td>
                  <td>0.36</td>
                  <td>0.50</td>
                </tr>
                <tr>
                  <td>A4</td>
                  <td>0.14</td>
                  <td>0.33</td>
                  <td>0.36</td>
                  <td>1.00</td>
                  <td>0.31</td>
                </tr>
                <tr>
                  <td>A5</td>
                  <td>0.18</td>
                  <td>0.38</td>
                  <td>0.50</td>
                  <td>0.31</td>
                  <td>1.00</td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_wgtnlobv7iw3j88i8e9x(i, j, css_id) {
        var table = document.getElementById("tinytable_jbxxis6ajiho0wn241hy");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_jbxxis6ajiho0wn241hy');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_wgtnlobv7iw3j88i8e9x(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_jbxxis6ajiho0wn241hy");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(0, 0, 'tinytable_css_9au0jpln13a7y8k8ahwu') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(0, 1, 'tinytable_css_9au0jpln13a7y8k8ahwu') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(0, 2, 'tinytable_css_9au0jpln13a7y8k8ahwu') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(0, 3, 'tinytable_css_9au0jpln13a7y8k8ahwu') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(0, 4, 'tinytable_css_9au0jpln13a7y8k8ahwu') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(0, 5, 'tinytable_css_9au0jpln13a7y8k8ahwu') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(1, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(2, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(3, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(4, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(5, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(1, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(2, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(3, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(4, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(5, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(1, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(2, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(3, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(4, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(5, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(1, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(2, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(3, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(4, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(5, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(1, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(2, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(3, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(4, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
window.addEventListener('load', function () { styleCell_tinytable_wgtnlobv7iw3j88i8e9x(5, 0, 'tinytable_css_xhgz86oyksklwoz24p9s') })
    </script>

  


</div>
</div>
</figure>
</div>
</div>
<p>From this correlation matrix we can use <a href="#eq-alpha-s" class="quarto-xref">Equation&nbsp;<span>6.9</span></a> to calculate the standardized alpha coefficient. In R, the <code>compute_alpha()</code> function in the <code>psychmeta</code> package <span class="citation" data-cites="psychmeta">(<a href="../references/references_page.html#ref-psychmeta" role="doc-biblioref">Dahlke and Wiernik 2019</a>)</span> takes in a correlation matrix (or a covariance matrix) as an argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(df)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation matrix from example table:</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># .34 1</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># .26 .48 1</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># .14 .33 .36 1</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># .18 .39 .50 .31 1</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">compute_alpha</span>(<span class="at">sigma =</span> corr_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7077484</code></pre>
</div>
</div>
<p>As expected, the reliability is identical to the standardized coefficient alpha computed from the raw data.</p>
</div>
</div>
</section>
<section id="mosiers-reliability" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="mosiers-reliability">Mosier’s Reliability</h4>
<p>Mosier’s <span class="citation" data-cites="mosier1943">(<a href="../references/references_page.html#ref-mosier1943" role="doc-biblioref">1943</a>)</span> reliability takes into account the within-sub-measurement reliability and weights formulation allows us to take the sub-measurement-level reliability as well as non-unit weights into account. In matrix notation,</p>
<p><span class="math display">\[
\rho_{\widetilde{X}\widetilde{X}'} = \frac{\mathbf{w}^\intercal(\mathbf{R}_\mathsf{\tilde{x}} - \mathbf{I} + \boldsymbol{\rho}_{\mathsf{\tilde{x}}\mathsf{\tilde{x}}'}\mathbf{I} )\mathbf{w}}{\boldsymbol{\mathbf{w}^\intercal\Sigma}_\mathsf{x}\mathbf{w} }.
\]</span></p>
<p>To describe the numerator: the correlation matrix between observed sub-scores <span class="math inline">\(\mathbf{R}_\mathsf{\tilde{x}}\)</span> is subtracted by a square <span class="math inline">\(\kappa\times\kappa\)</span> identity matrix <span class="math inline">\(\mathbf{I}\)</span> (1s in the diagonal, 0s in the off-diagonals) in effect removing the diagonal 1s in the correlation matrix, then the diagonal is replaced with <span class="math inline">\(\boldsymbol{\rho}_{\mathsf{\tilde{x}}\mathsf{\tilde{x}}'}\mathbf{I}\)</span> which is a an identity matrix where the diagonals are now the within-sub-measurement reliability coefficients. The denominator just contains the observed sub-score correlation matrix <span class="math inline">\(\mathbf{R}_\mathsf{\tilde{x}}\)</span>. The vector of weights <span class="math inline">\(\mathbf{w}\)</span> acts as a weighted summation for the numerator and denominator. If the weights are simply unit weights, then the formula simplifies to,</p>
<p><span class="math display">\[
\rho_{\widetilde{X}\widetilde{X}'} = \frac{\bar{\rho}_{\mathsf{\tilde{x}} \mathsf{\tilde{x}}'} + (\kappa - 1)\bar{\rho}_{\mathsf{\tilde{x}}_q \mathsf{\tilde{x}}_j}}{1+(\kappa-1)\bar{\rho}_{\mathsf{\tilde{x}}_q \mathsf{\tilde{x}}_j}}.
\]</span></p>
<p>Where <span class="math inline">\(\bar{\rho}_{\mathsf{\tilde{x}} \mathsf{\tilde{x}}'}\)</span> is the average reliability across all <span class="math inline">\(q\)</span> sub-measurements. Mosier’s reliability, as opposed to Coefficient alpha, is an upper bound. One of the potential issues with using coefficient alpha for effect size corrections is that it assumes that the correlations between the true sub-scores for each sub-measurement are perfect, <span class="math inline">\(\rho_{\mathsf{\tilde{x}}_q \mathsf{\tilde{x}}_j}=1\)</span>. The problem is that if the true scores do not correlate perfectly, than there may be true sub-score variance that is not captured by alpha. Therefore Mosier’s reliability uses the true variance for each sub-measurement by including it’s reliability. An example of this dilemma: if we want to estimate the reliability of the full-scale IQ score from a battery of cognitive tests like working memory, visuo-spatial reasoning, vocabulary knowledge, etc. then estimating coefficient alpha from the inter-correlations between these sub-test scores will index the true variance that is shared between working memory, reasoning, and knowledge without considering the true variance that is unique to each sub-test. Luckily these subtests usually consist of sub-measurements themselves (i.e., test items) and therefore calculating reliability for each sub-test is not a problem. However, this can become problematic in the case of Likert items where it is quite reasonable to suspect that there is true sub-score variance that is independent, it is often impossible to estimate the reliability.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mosier’s Reliability in R
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>psychTools</code> package <span class="citation" data-cites="psychTools">(<a href="../references/references_page.html#ref-psychTools" role="doc-biblioref">William Revelle 2024</a>)</span> contains data on the cognitive abilities from the (ICAR) data base. There are four sub-tests consisting of basic reasoning, letter series, matrix reasoning, and spatial rotation. Let’s first load in the data set and impute missing values using predictive mean matching <span class="citation" data-cites="missRanger">(<a href="../references/references_page.html#ref-missRanger" role="doc-biblioref">Mayer 2023</a>)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psychTools)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psychmeta)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(missRanger)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Clean data</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ability) <span class="sc">|&gt;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># impute missing values multivariately</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">missRanger</span>(<span class="at">verbose=</span>F,<span class="at">pmm.k =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using the <code>compute_composite_matrix</code> function from the <code>psychmeta</code> package <span class="citation" data-cites="psychmeta">(<a href="../references/references_page.html#ref-psychmeta" role="doc-biblioref">Dahlke and Wiernik 2019</a>)</span> we can compute Mosier’s reliability. First we need to compute the coefficient alpha for each subtest:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize empty vector</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>reliability <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compute alpha for reasoning test</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>reliability[<span class="st">"reasoning"</span>] <span class="ot">&lt;-</span> <span class="fu">compute_alpha</span>(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="fu">cov</span>(df[,ability.keys<span class="sc">$</span>reasoning]),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>reliability[<span class="st">"letters"</span>] <span class="ot">&lt;-</span> <span class="fu">compute_alpha</span>(</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="fu">cov</span>(df[,ability.keys<span class="sc">$</span>letters]),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>reliability[<span class="st">"matrix"</span>] <span class="ot">&lt;-</span> <span class="fu">compute_alpha</span>(</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="fu">cov</span>(df[,ability.keys<span class="sc">$</span>matrix]),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>reliability[<span class="st">"rotate"</span>] <span class="ot">&lt;-</span> <span class="fu">compute_alpha</span>(</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="fu">cov</span>(df[,ability.keys<span class="sc">$</span>rotate]),</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>reliability</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>reasoning   letters    matrix    rotate 
0.6357177 0.6631134 0.5363879 0.7640922 </code></pre>
</div>
</div>
<p>The reliabilities for each test are poor, but our goal is to create a composite full scale IQ score from this test which should be more reliable than each of the sub-tests by themselves. Let’s compute the composite scores:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>composite_scores <span class="ot">&lt;-</span>  df <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute subtest scores</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">reasoning =</span> reason<span class="fl">.4</span> <span class="sc">+</span> reason<span class="fl">.16</span> <span class="sc">+</span> reason<span class="fl">.17</span> <span class="sc">+</span> reason<span class="fl">.19</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">letters =</span> letter<span class="fl">.7</span> <span class="sc">+</span> letter<span class="fl">.33</span> <span class="sc">+</span> letter<span class="fl">.34</span> <span class="sc">+</span> letter<span class="fl">.58</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">matrix =</span> matrix<span class="fl">.45</span> <span class="sc">+</span> matrix<span class="fl">.46</span> <span class="sc">+</span> matrix<span class="fl">.47</span> <span class="sc">+</span> matrix<span class="fl">.55</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">rotate =</span> rotate<span class="fl">.3</span> <span class="sc">+</span> rotate<span class="fl">.4</span> <span class="sc">+</span> rotate<span class="fl">.6</span> <span class="sc">+</span> rotate<span class="fl">.8</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># keep only the composite scores</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(reasoning, letters, matrix, rotate) <span class="sc">|&gt;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute IQ scores</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IQ =</span> reasoning <span class="sc">+</span> letters <span class="sc">+</span> matrix <span class="sc">+</span> rotate)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(composite_scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   reasoning letters matrix rotate IQ
5          0       1      1      0  2
6          1       2      0      1  4
7          2       1      2      0  5
8          2       1      0      0  3
9          3       1      2      0  6
10         4       4      3      3 14</code></pre>
</div>
</div>
<p>Then we can compute mosier’s reliability for IQ scores using the <code>composite_rel_matrix()</code> function in the <code>psychmeta</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create subtest data frame with just subtests (w/ IQ)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>subtests <span class="ot">&lt;-</span> composite_scores <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(reasoning,letters,matrix,rotate)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation matrix between subtest scores</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(subtests)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create a vector of 1s to get standardized reliability</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>sds <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># compute Mosier's reliability</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="fu">composite_rel_matrix</span>(<span class="at">rel_vec =</span> reliability,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">r_mat =</span> corr_matrix,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sd_vec =</span> sds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8451205</code></pre>
</div>
</div>
<p>As expected, the reliability is much larger for the full scale IQ scores than the individual subtests. Let’s briefly compare this value with coefficient alpha which does not take into account the reliability of each subtest:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compute_alpha</span>(<span class="fu">cor</span>(subtests))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7436062</code></pre>
</div>
</div>
<p>The reliability is much lower. This is because the total true score variance does not include the true score variance that is exclusive to each subtest.</p>
</div>
</div>
</section>
</section>
<section id="coefficient-of-stability" class="level3" data-number="6.3.2">
<h3 data-number="6.3.2" class="anchored" data-anchor-id="coefficient-of-stability"><span class="header-section-number">6.3.2</span> Coefficient of Stability</h3>
<p>Transient errors represent fluctuations in observed scores over time. These fluctuations, even if they are systematic (e.g., fatigue over the course of a single day), add extraneous variance that can mask individual differences. Considering transient fluctuations as error depends on the research goal, so it is important for researchers to take care in considering which types of sources of variance that should be considered error in their study. A coefficient of stability (also referred to as test-retest reliability) is simply the correlation between observed scores upon repeated measurements. Note that calculating the Pearson correlation coefficient between time-points ignores systematic changes (e.g., practice effects). We can visualize test-retest reliability in <a href="#fig-test-retest" class="quarto-xref">Figure&nbsp;<span>6.2</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-test-retest" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-test-retest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05-error-in-continuous-variables_files/figure-html/fig-test-retest-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-test-retest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.2: Illustrating test-retest reliability. Top-left and top-right panels show the correlation between observed scores at both time-points for a measure that has low and high reliability, respectively. Bottom-left and bottom-right panels show the within-person change from time-point 1 to time-point 2 for scores with low and high reliability, respectively.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="alpha-coefficient-of-stability" class="level3" data-number="6.3.3">
<h3 data-number="6.3.3" class="anchored" data-anchor-id="alpha-coefficient-of-stability"><span class="header-section-number">6.3.3</span> Alpha Coefficient of Stability</h3>
<p>If we want to capture both transient error <em>and</em> sub-measurement error variance, then we can also calculate the alpha coefficient of stability (also known as the test-retest alpha). This reliability estimate is the average split half correlation across two time points. Specifically, the procedure is as follows,</p>
<ol type="1">
<li><p>Split the set of sub-measurements for each time point into a two halves where both time points have the same split.</p></li>
<li><p>Then calculate the split half reliability using <a href="#eq-sh-u" class="quarto-xref">Equation&nbsp;<span>6.10</span></a> or <a href="#eq-sh-s" class="quarto-xref">Equation&nbsp;<span>6.11</span></a> between the composite of first half from time point 1 and second half from time point 2.</p></li>
<li><p>Repeat step 1 and 2 for all possible halves and the average is the alpha coefficient of stability.</p></li>
</ol>
</section>
</section>
<section id="sec-correcting-correlations-me" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="sec-correcting-correlations-me"><span class="header-section-number">6.4</span> Correcting Correlations</h2>
<section id="defining-the-target-correlation" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="defining-the-target-correlation"><span class="header-section-number">6.4.1</span> Defining the Target Correlation</h3>
<p>The target correlation for this section can be defined as the population correlation between between true scores, <span class="math inline">\(\rho_{XY}\)</span>. This can be related to observed sample correlation between observed proxy scores via the relation,</p>
<p><span class="math display">\[
r_{\widetilde{X}\widetilde{Y}} = \alpha \rho_{XY} + \varepsilon_r,
\]</span> where <span class="math inline">\(\alpha\)</span> is the artifact attenuation/inflation factor and <span class="math inline">\(\varepsilon_r\)</span> is the the sampling error term.</p>
</section>
<section id="sec-r-corr" class="level3" data-number="6.4.2">
<h3 data-number="6.4.2" class="anchored" data-anchor-id="sec-r-corr"><span class="header-section-number">6.4.2</span> Artifact Correction for Correlations</h3>
<p>Classical measurement error induces systematic bias in effect size estimates such as correlation coefficients <span class="citation" data-cites="hunter1990a">C. Spearman (<a href="../references/references_page.html#ref-spearman1904" role="doc-biblioref">1904</a>)</span>. In the population, let us assume there is some factor <span class="math inline">\(\alpha\)</span> that accounts for the systematic bias in observed score correlations (<span class="math inline">\(\rho_{\widetilde{X}\widetilde{Y}}\)</span>) relative to true score correlations (<span class="math inline">\(\rho_{XY}\)</span>), such that</p>
<p><span id="eq-atten"><span class="math display">\[
\rho_{\widetilde{X}\widetilde{Y}} = \alpha \rho_{XY}.
\tag{6.12}\]</span></span></p>
<p>Since the correlation is defined as the covariance standardized by the standard deviations, the population correlation between true scores, <span class="math inline">\(T\)</span> and <span class="math inline">\(U\)</span>, is defined as,</p>
<p><span id="eq-true-corr"><span class="math display">\[
\rho_{XY}=\frac{\sigma_{XY}}{\sigma_{X} \sigma_{Y}}.
\tag{6.13}\]</span></span></p>
<p>Likewise the correlation between the observed scores, <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, would be the observed covariance divided by the observed standard deviations,</p>
<p><span class="math display">\[
\rho_{\widetilde{X}\widetilde{Y}} =\frac{\sigma_{\widetilde{X}\widetilde{Y}}}{\sigma_\widetilde{X} \sigma_\widetilde{Y}}.
\]</span></p>
<p>However, if we assume that there is no covariance between errors <span class="math inline">\(\sigma_{E_X E_Y} = 0\)</span>, then the covariance between observed scores is only attributable to the covariance between true scores, therefore <span class="math inline">\(\sigma_{\widetilde{X}\widetilde{Y}} = \sigma_{XY}\)</span>. This means that the observed score correlation can be expressed with the true score covariance in the numerator,</p>
<p><span id="eq-obs-corr"><span class="math display">\[
\rho_{\widetilde{X}\widetilde{Y}} =\frac{\sigma_{XY}}{\sigma_\widetilde{X} \sigma_\widetilde{Y}}.
\tag{6.14}\]</span></span></p>
<p>Now the only difference between the observed score correlation (<a href="#eq-obs-corr" class="quarto-xref">Equation&nbsp;<span>6.14</span></a>) and the true score correlation (<a href="#eq-true-corr" class="quarto-xref">Equation&nbsp;<span>6.13</span></a>) is the standard deviations in the denominator. In the presence of measurement error, the observed score standard deviations (<span class="math inline">\(\sigma_\widetilde{X}\)</span> and <span class="math inline">\(\sigma_\widetilde{Y}\)</span>) will be larger than the true score standard deviations (<span class="math inline">\(\sigma_X\)</span> and <span class="math inline">\(\sigma_Y\)</span>). Using the definition of reliability, we can show how the observed standard deviation is inflated compared to the true variance as a function of reliability. Since the reliability is defined as the ratio of true variance to total observed variance (see <a href="#eq-reliability" class="quarto-xref">Equation&nbsp;<span>6.5</span></a>), we can see how reliability inflates the observed variance,</p>
<p><span class="math display">\[\begin{aligned}
\sigma^2_\widetilde{X} &amp;=\sigma^2_{X} \left(\frac{\sigma^2_\widetilde{X}}{\sigma^2_X} \right)\\[.3em]
&amp;= \sigma^2_X\left(\frac{1}{\rho_{\widetilde{X}\widetilde{X}'}} \right)\\[.3em]
&amp;= \frac{\sigma^2_{T}}{\rho_{\widetilde{X}\widetilde{X}'}}.
\end{aligned}\]</span></p>
<p>Therefore the observed standard deviation is,</p>
<p><span id="eq-sd-me"><span class="math display">\[
\sigma_\widetilde{X} = \frac{\sigma_{X}}{\sqrt{\rho_{\widetilde{X}\widetilde{X}'}}}.
\tag{6.15}\]</span></span></p>
<p>Since the reliability, and its square root, will be less than 1, the observed score variance will be larger than the true score variance <span class="math inline">\(\sigma_X \geq \sigma_\widetilde{X}\)</span>. If we use the definition of an observed score correlation in <a href="#eq-obs-corr" class="quarto-xref">Equation&nbsp;<span>6.14</span></a>, then we can replace <span class="math inline">\(\sigma_\widetilde{X}\)</span> and <span class="math inline">\(\sigma_\widetilde{Y}\)</span> with <span class="math inline">\(\frac{\sigma_X}{\sqrt{\rho_{\widetilde{X}\widetilde{X}'}}}\)</span> and <span class="math inline">\(\frac{\sigma_Y}{\sqrt{\rho_{\widetilde{Y}\widetilde{Y}'}}}\)</span>, respectively. Now we can show mathematically, how the observed score correlation differs from the true score correlation:</p>
<p><span class="math display">\[\begin{aligned}
\rho_{\widetilde{X}\widetilde{Y}} &amp;= \frac{\sigma_{XY}}{\left[\frac{\sigma_X}{\sqrt{\rho_{\widetilde{X}\widetilde{X}'}}} \right] \left[ \frac{\sigma_Y}{\sqrt{\rho_{\widetilde{Y}\widetilde{Y}'}}} \right] } \\[.3em]
&amp;=  \sqrt{\rho_{\widetilde{X}\widetilde{X}'}}\sqrt{\rho_{\widetilde{Y}\widetilde{Y}'}}\,\times\frac{\sigma_{XY}}{\sigma_X\sigma_Y} \\[.3em]
&amp;= \underset{\alpha}{\underbrace{\sqrt{\rho_{\widetilde{X}\widetilde{X}'}}\sqrt{\rho_{\widetilde{Y}\widetilde{Y}'}}} } \times \rho_{XY}
\end{aligned}\]</span></p>
<p>Therefore the attenuation factor described in <a href="#eq-atten" class="quarto-xref">Equation&nbsp;<span>6.12</span></a> is,</p>
<p><span id="eq-atten-factor"><span class="math display">\[
\alpha = \sqrt{\rho_{\widetilde{X}\widetilde{X}'}}\sqrt{\rho_{\widetilde{Y}\widetilde{Y}'}}
\tag{6.16}\]</span></span></p>
<p>This attenuation formula was first derived by Charles Spearman <span class="citation" data-cites="spearman1904">(<a href="../references/references_page.html#ref-spearman1904" role="doc-biblioref">1904</a>)</span>. This derivation. See <a href="#fig-attenuation" class="quarto-xref">Figure&nbsp;<span>6.3</span></a> for a visualization of the attenuation.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-attenuation" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-attenuation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05-error-in-continuous-variables_files/figure-html/fig-attenuation-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-attenuation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.3: Visualizing the attenuation of an observed score correlation (<span class="math inline">\(\rho_{XY}\)</span>) due to measurement error. Top left panel shows a scatter plot of the correlation between the true scores of the independent and dependent variable. Top right panel shows a scatter plot of the correlation between the observed scores of the independent and dependent variable. The bottom left panel shows the reliability of a single variable and it’s relationship with the observed score correlation (<span class="math inline">\(\rho_{XY}\)</span>) while varying the true score correlation (true score correlations are represented as the red dots, i.e., when reliability is perfect). The bottom right panel shows attenuation of a a true score correlation, when both <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are affected by measurement error. The darker red indicates a larger observed correlation, where it peaks at an observed score correlation of .50 (when reliability of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is 1) which is equivalent to the true score correlation.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Let us recall that we can express the study sample correlation between observed scores as a function of the true score population correlation (i.e., the target correlation, <span class="math inline">\(\rho_{XY}\)</span>),</p>
<p><span class="math display">\[
r_{\widetilde{X}\widetilde{Y}} = \alpha\rho_{XY} + \varepsilon_r.
\]</span></p>
<p>Now that we have derived the attenuation factor <span class="math inline">\(\alpha\)</span> we can plug in it’s actual form from <a href="#eq-atten-factor" class="quarto-xref">Equation&nbsp;<span>6.16</span></a>,</p>
<p><span class="math display">\[
r_{\widetilde{X}\widetilde{Y}} = \left(\sqrt{\rho_{\widetilde{X}\widetilde{X}'}}\sqrt{\rho_{\widetilde{Y}\widetilde{Y}'}}\right) \rho_{XY} + \varepsilon_r.
\]</span></p>
<p>We could use the <span class="math inline">\(\alpha\)</span> coefficient to correct the correlation by dividing both sides of the above equation, however the population reliabilities <span class="math inline">\(\rho_{\widetilde{X}\widetilde{X}'}\)</span> and <span class="math inline">\(\rho_{\widetilde{Y}\widetilde{Y}'\)</span> are unknown in practice and therefore we have to use sample estimates. Since we must use sample estimates of reliability, then that means we only have access to a sample estimate of <span class="math inline">\(\alpha\)</span> which we denote with the English letter <span class="math inline">\(a\)</span>. Therefore we can correct the observed score study correlation by dividing by an estimate the attenuation factor using,</p>
<p><span class="math display">\[
r_{XY} = \frac{r_{\widetilde{X}\widetilde{Y}}}{a} = \frac{r_{XY}}{\sqrt{r_{\widetilde{X}\widetilde{X}'}}\sqrt{r_{\widetilde{Y}\widetilde{Y}'}}}
\]</span></p>
<p>The corrected correlation coefficient is a consistent estimator of the target correlation, <span class="math inline">\(\rho_{XY}\)</span>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correcting Correlations in R
</div>
</div>
<div class="callout-body-container callout-body">
<p>A study reports the correlation between mean reaction time and exam grades of <span class="math inline">\(r_{\widetilde{X},\widetilde{Y}}=.40\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psychmeta)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rXY <span class="ot">&lt;-</span> .<span class="dv">40</span>  <span class="co"># correlation between X and Y</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>rXX <span class="ot">&lt;-</span> .<span class="dv">80</span>  <span class="co"># reliability of X</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>rYY <span class="ot">&lt;-</span> .<span class="dv">70</span>  <span class="co"># reliability of Y</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>    <span class="co"># sample size</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># correct correlation</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">correct_r</span>(<span class="at">correction =</span> <span class="st">'meas'</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">rxyi =</span> rXY,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">rxx =</span> rXX,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">ryy =</span> rYY)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Correlations Corrected for Measurement Error:
---------------------------------------------------------------------------------------
  rxy   rxp   rty   rtp
1 0.4 0.478 0.447 0.535</code></pre>
</div>
</div>
<p>In the psychmeta package, they show the correction for each variable therefore <code>rxy</code> is the observed correlation, <code>rxp</code> is corrected for the measurement error in <span class="math inline">\(Y\)</span>, <code>rty</code> is corrected for measurement error in <span class="math inline">\(X\)</span>, and <code>rtp</code> is the correlation corrected for measurement error in both variables. Therefore sample estimate of the true score correlation is <span class="math inline">\(r_{XY} = .535\)</span>.</p>
</div>
</div>
<section id="sampling-variance-of-corrected-correlation" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="sampling-variance-of-corrected-correlation">Sampling Variance of Corrected Correlation</h4>
<p>The next step is to obtain the sampling variance of the corrected correlation coefficient. The sampling variance of the uncorrected correlation, <span class="math inline">\(\mathrm{var}(r_{\widetilde{X}\widetilde{Y}})\)</span>, can be adjusted directly. If we treat the reliability coefficients as fixed as the correlation, then the standard error formula can be calculated simply as,</p>
<p><span class="math display">\[
\mathrm{var}(r_{XY}) =  \frac{\mathrm{var}(r_{\widetilde{X}\widetilde{Y}})}{r_{XX'}r_{YY'}}
\]</span></p>
<p>This formula generally performs pretty well, however there are two additional methods that are preferrable: Bootstrapping and Taylor series approximations. If the raw data is available, then a sampling with replacement procedure (i.e., bootstrapping) can provide a non-parametric estimate of the sampling variance.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bootstrapping Corrected Correlations in R
</div>
</div>
<div class="callout-body-container callout-body">
<p>As an example in R, we can calculate the sampling variance between Extraversion and Agreeableness sum scores from the <code>bfi</code> data set in the <code>psych</code> package <span class="citation" data-cites="psych">(<a href="../references/references_page.html#ref-psych" role="doc-biblioref">William Revelle 2023</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psychmeta)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(missRanger)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># clean data and compute composites</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> bfi <span class="sc">|&gt;</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(A1,A2,A3,A4,A5,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>                E1,E2,E3,E4,E5) <span class="sc">|&gt;</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">A1 =</span> <span class="dv">6</span><span class="sc">-</span>A1, <span class="at">E1 =</span> <span class="dv">6</span><span class="sc">-</span>E1, <span class="at">E2 =</span> <span class="dv">6</span><span class="sc">-</span>E2) <span class="sc">|&gt;</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">A =</span> A1 <span class="sc">+</span> A2 <span class="sc">+</span> A3 <span class="sc">+</span> A4 <span class="sc">+</span> A5,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">E =</span> E1 <span class="sc">+</span> E2 <span class="sc">+</span> E3 <span class="sc">+</span> E4 <span class="sc">+</span> E5) <span class="sc">|&gt;</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">imputeUnivariate</span>()</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize corrected correlation vector</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>rAE_corrected <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co"># loop through 1500 bootstrap iterations</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1500</span>){</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sample the data with replacement</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  boot <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df),<span class="fu">nrow</span>(df),<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  boot_df <span class="ot">&lt;-</span> df[boot,]</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute bootstrap correlation matrix for each trait</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  corr_mat_A <span class="ot">&lt;-</span> <span class="fu">cor</span>(boot_df[,<span class="fu">c</span>(<span class="st">"A1"</span>,<span class="st">"A2"</span>,<span class="st">"A3"</span>,<span class="st">"A4"</span>,<span class="st">"A5"</span>)])</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  corr_mat_E <span class="ot">&lt;-</span> <span class="fu">cor</span>(boot_df[,<span class="fu">c</span>(<span class="st">"E1"</span>,<span class="st">"E2"</span>,<span class="st">"E3"</span>,<span class="st">"E4"</span>,<span class="st">"E5"</span>)])</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute reliability</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>  rAA <span class="ot">&lt;-</span> <span class="fu">compute_alpha</span>(corr_mat_A)</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  rEE <span class="ot">&lt;-</span> <span class="fu">compute_alpha</span>(corr_mat_E)</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute correlation between composites</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>  rAE <span class="ot">&lt;-</span> <span class="fu">cor</span>(boot_df<span class="sc">$</span>A, boot_df<span class="sc">$</span>E)</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># correct correlation</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>  rAE_corrected[i] <span class="ot">&lt;-</span> rAE <span class="sc">/</span> <span class="fu">sqrt</span>(rAA<span class="sc">*</span>rEE)</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="co"># bootstrapped variance estimate</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(rAE_corrected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0004839236</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## compare bootstrapped variance with closed form</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>var_observed <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">cor</span>(df<span class="sc">$</span>A,df<span class="sc">$</span>E)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="fu">nrow</span>(df)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>rAA <span class="ot">&lt;-</span> <span class="fu">compute_alpha</span>(<span class="fu">cor</span>(df[,<span class="fu">c</span>(<span class="st">"A1"</span>,<span class="st">"A2"</span>,<span class="st">"A3"</span>,<span class="st">"A4"</span>,<span class="st">"A5"</span>)]))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>rEE <span class="ot">&lt;-</span> <span class="fu">compute_alpha</span>(<span class="fu">cor</span>(df[,<span class="fu">c</span>(<span class="st">"E1"</span>,<span class="st">"E2"</span>,<span class="st">"E3"</span>,<span class="st">"E4"</span>,<span class="st">"E5"</span>)]))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>var_corrected <span class="ot">&lt;-</span> var_observed <span class="sc">/</span> (rAA <span class="sc">*</span> rEE)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># closed form variance estimate</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>var_corrected</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0004384132</code></pre>
</div>
</div>
<p>In this example, the bootstrapped sampling variance and the closed form are nearly equal.</p>
</div>
</div>
<p><span class="citation" data-cites="bobko1980">Bobko and Rieck (<a href="../references/references_page.html#ref-bobko1980" role="doc-biblioref">1980</a>)</span> derived sampling variance formulas from Taylor series approximations for three different situations. However <span class="citation" data-cites="bobko1980">Bobko and Rieck (<a href="../references/references_page.html#ref-bobko1980" role="doc-biblioref">1980</a>)</span> only derived them for correcting the correlation only for the dependent variable <span class="math inline">\(Y\)</span>. Using the same methodology as <span class="citation" data-cites="bobko1980">Bobko and Rieck (<a href="../references/references_page.html#ref-bobko1980" role="doc-biblioref">1980</a>)</span> I derive the variance of the corrected correlation in the case where reliability estimates and correlations come from an independent samples (e.g., reliability comes from a test manual and not from the study sample). The formula requires the sample size for the study sample <span class="math inline">\(n\)</span> as well as for the samples where the reliability coefficients were estimated <span class="math inline">\(n_{r_{\widetilde{X}\widetilde{X}'}}\)</span> and <span class="math inline">\(n_{r_{\widetilde{Y}\widetilde{Y}'}}\)</span>.</p>
<p><span id="eq-se-me-r-tsa"><span class="math display">\[\begin{align}
\mathrm{var}(r_{XY}) =&amp; \frac{se(r_{\widetilde{X}\widetilde{Y}})^2}{r_{\widetilde{X}\widetilde{X}'}r_{\widetilde{Y}\widetilde{Y}'}} \\
+ &amp;\frac{r^2_{\widetilde{X}\widetilde{Y}}\left(1-r^2_{\widetilde{X}\widetilde{X}'}\right)^2}{4(n_{r_{\widetilde{X}\widetilde{X}'}}-1)r_{\widetilde{X}\widetilde{X}'}^3r_{\widetilde{Y}\widetilde{Y}'}} \\
&amp;+\frac{r^2_{\widetilde{X}\widetilde{Y}}\left(1-r^2_{\widetilde{Y}\widetilde{Y}'}\right)^2}{4(n_{r_{\widetilde{Y}\widetilde{Y}'}}-1)r_{\widetilde{X}\widetilde{X}'}r_{\widetilde{Y}\widetilde{Y}'}^3}
\end{align} \tag{6.17}\]</span></span></p>
<p>The full derivation can be found seen in the Appendix of this chapter.</p>
</section>
</section>
<section id="differential-measurement-error" class="level3" data-number="6.4.3">
<h3 data-number="6.4.3" class="anchored" data-anchor-id="differential-measurement-error"><span class="header-section-number">6.4.3</span> Differential Measurement Error</h3>
<p>Before we move on to correcting standardized mean differences, I have to confess, I snuck in a major assumption earlier in this section:</p>
<blockquote class="blockquote">
<p>However, if we assume that there is no covariance between errors <span class="math inline">\(\sigma_{E_X E_Y} = 0\)</span>, then the covariance between observed scores is only attributable to the covariance between true scores, therefore <span class="math inline">\(\sigma_{\widetilde{X}\widetilde{Y}} = \sigma_{XY}\)</span>.</p>
</blockquote>
<p>The problem with this assumption is that the corrected correlation can be under-estimated if <span class="math inline">\(\sigma_{E_XE_Y}&lt;0\)</span> or over-estimated if <span class="math inline">\(\sigma_{E_XE_Y}&gt;0\)</span>. A conservative correction approach would be to use Mosier’s reliability in the correction procedure allowing there to be true variance which will reduce the likelihood that the correction is an over-estimation. A better correction procedure would be to use the one introduced by <span class="citation" data-cites="zimmerman1977">Donald W. Zimmerman and Williams (<a href="../references/references_page.html#ref-zimmerman1977" role="doc-biblioref">1977</a>)</span>,</p>
<p><span id="eq-diff-correction"><span class="math display">\[
r_{XY} = \frac{r_{\widetilde{X}\widetilde{Y}}}{\sqrt{r_{\widetilde{X}\widetilde{X}}}\sqrt{r_{\widetilde{Y}\widetilde{Y}}}} -\frac{r_{E_XE_Y} \sqrt{1-r_{\widetilde{Y}\widetilde{Y}}}\sqrt{1-r_{\widetilde{Y}\widetilde{Y}}}}{\sqrt{r_{\widetilde{X}\widetilde{X}}}\sqrt{r_{\widetilde{Y}\widetilde{Y}}}}
\tag{6.18}\]</span></span> Notice that the first term is identical to the correction formula described earlier, in fact, if the <span class="math inline">\(r_{E_XE_Y}\)</span> is set to zero, we would recover the original correction formula. The problem with <a href="#eq-diff-correction" class="quarto-xref">Equation&nbsp;<span>6.18</span></a> is that it requires an estimate of <span class="math inline">\(r_{E_XE_Y}\)</span> which is only attainable if the raw data is available, since this would rarely be reported directly.</p>
</section>
</section>
<section id="correcting-standardized-mean-differences-smd" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="correcting-standardized-mean-differences-smd"><span class="header-section-number">6.5</span> Correcting Standardized Mean Differences (SMD)</h2>
<section id="defining-the-target-smd" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1" class="anchored" data-anchor-id="defining-the-target-smd"><span class="header-section-number">6.5.1</span> Defining the Target SMD</h3>
<p>Prior to correcting for measurement error let us define our target effect size. Our target effect size is the SMD between groups 0 and 1 with respect to the true scores, <span class="math inline">\(Y\)</span>, of our dependent variable,</p>
<p><span class="math display">\[
\delta_{GY} = \frac{\mu_{Y|G=1} - \mu_{Y|G=0}}{\sigma_{Y|G}}.
\]</span></p>
<p>Where <span class="math inline">\(\mu_{Y|G=1}\)</span> and <span class="math inline">\(\mu_{Y|G=0}\)</span> is the conditional population mean for each group (<span class="math inline">\(G\)</span>). If we are given a sample observed score SMD, then we can express the relationship between the population true score SMD (<span class="math inline">\(\delta_{GY}\)</span>) and our observed SMD with our effect size model:</p>
<p><span class="math display">\[
d_{GY} = \alpha\delta_{GY}+\varepsilon_d.
\]</span></p>
<p>Where <span class="math inline">\(\alpha\)</span> is the attenuation factor induced by measurement error and <span class="math inline">\(\varepsilon_d\)</span> denotes sampling error.</p>
</section>
<section id="sec-d-SMD" class="level3" data-number="6.5.2">
<h3 data-number="6.5.2" class="anchored" data-anchor-id="sec-d-SMD"><span class="header-section-number">6.5.2</span> Artifact Correction for SMDs</h3>
<p>The population mean of true scores and observed scores are identical since classical measurement error, as defined here, only affects the variance in scores. Therefore the population mean difference is equivalent for true scores and observed scores,</p>
<p><span class="math display">\[
\underset{\textsf{observed score mean diff}}{\underbrace{\mu_{\widetilde{Y}|G=1} - \mu_{\widetilde{Y}|G=0}}}= \underset{\textsf{true score mean diff}}{\underbrace{\mu_{Y|G=1} - \mu_{Y|G=0}}}.
\]</span></p>
<p>This means that an unstandardized mean difference is <em>not</em> biased by classical measurement error. Taking advantage of this fact, we can express an observed score SMD with replacing the observed score mean difference in the numerator with the true score mean difference such that,</p>
<p><span id="eq-smd-obs"><span class="math display">\[
\delta_{G\widetilde{Y}} = \overset{\textsf{observed score mean diff}}{\overbrace{\frac{\mu_{\widetilde{Y}|G=1} - \mu_{\widetilde{Y}|G=0}}{\sigma_{\widetilde{Y}|G}}}}  = \overset{\textsf{true score mean diff}}{\overbrace{\frac{ \mu_{Y|G=1} - \mu_{Y|G=0}}{\sigma_{\widetilde{Y}|G}}}}
\tag{6.19}\]</span></span></p>
<p>Similar to <a href="#eq-sd-me" class="quarto-xref">Equation&nbsp;<span>6.15</span></a>, the observed score within-group standard deviation <span class="math inline">\(\sigma_{\widetilde{Y}|G}\)</span> can be expressed in terms of the true score within-group standard deviation <span class="math inline">\(\sigma_{Y|G}\)</span> and the within-group reliability <span class="math inline">\(\rho_{\widetilde{Y}\widetilde{Y}'|G}\)</span>,</p>
<p><span class="math display">\[
\sigma_{\widetilde{Y}|G}=\frac{\sigma_{Y|G}}{\sqrt{\rho_{\widetilde{Y}\widetilde{Y}'|G}}}
\]</span></p>
<p>We can then plug this in for <span class="math inline">\(\sigma_{\widetilde{Y}|G}\)</span> in the observed score SMD formula (<a href="#eq-smd-obs" class="quarto-xref">Equation&nbsp;<span>6.19</span></a>) which will allow us to recover the true score SMD and parse out the artifact attenuation coefficient <span class="math inline">\(\alpha\)</span>,</p>
<p><span class="math display">\[\begin{aligned}
\delta_{G\widetilde{Y}} &amp;=\frac{\mu_{Y|G=1} - \mu_{Y|G=0}}{\sigma_{\widetilde{Y}|G}}  \\[.3em]
&amp;=  \frac{\mu_{Y|G=1} - \mu_{Y|G=0}}{\left[\frac{\sigma_{Y|G}}{\sqrt{\rho_{\widetilde{Y}\widetilde{Y}'|G}}}\right]} \\[.3em]
&amp;= \underset{\alpha}{\underbrace{\sqrt{\rho_{\widetilde{Y}\widetilde{Y}'|G}}} } \times \delta_{GY}.
\end{aligned}\]</span></p>
<p>Therefore the artifact attenuation factor <span class="math inline">\(\alpha\)</span> is,</p>
<p><span id="eq-atten-d"><span class="math display">\[
\alpha = \sqrt{\rho_{\widetilde{Y}\widetilde{Y}'|G}}.
\tag{6.20}\]</span></span></p>
<p>For a given sample, the within-group reliability and thus the artifact attenuation factor must be estimated. The sample estimate of the within-group reliability can be estimated from pooling the reliability in group 0 (<span class="math inline">\(\rho_{\widetilde{Y}\widetilde{Y}'|G=0}\)</span>) and group 1 (<span class="math inline">\(\rho_{\widetilde{Y}\widetilde{Y}'|G=1}\)</span>),</p>
<p><span class="math display">\[
r_{\widetilde{Y}\widetilde{Y}'|G} = \frac{(n_0-1)r_{\widetilde{Y}\widetilde{Y}'|G=0} + (n_1-1) r_{\widetilde{Y}\widetilde{Y}'|G=1}}{n -2},
\]</span> where <span class="math inline">\(n = n_0 + n_1\)</span>. Using <a href="#eq-atten-d" class="quarto-xref">Equation&nbsp;<span>6.20</span></a> we can correct the SMD with the sample estimate <span class="math inline">\(a=\sqrt{r_{\widetilde{Y}\widetilde{Y}'|G}}\)</span>,</p>
<p><span class="math display">\[
d_{GY} = \frac{d_{G\widetilde{Y}}}{a} = \frac{d_{G\widetilde{Y}}}{\sqrt{r_{\widetilde{Y}\widetilde{Y}'|G}}}.
\]</span> See <a href="#fig-d-attenuation" class="quarto-xref">Figure&nbsp;<span>6.4</span></a> for an illustration of how SMDs are affected by classical measurement error.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-d-attenuation" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-d-attenuation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05-error-in-continuous-variables_files/figure-html/fig-d-attenuation-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-d-attenuation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.4: Visualizing the attenuation of the standardized mean differences. Even though the means (dashed lines) do not change in the true score (top plot, in blue) and observed score distributions (bottom plot, in red), the true score distributions have a narrower variance than the observed score distributions. Since the variance and thus standard deviations are larger in the observed scores, the SMD in the observed scores is smaller than the true scores.
</figcaption>
</figure>
</div>
</div>
</div>
<section id="sampling-variance-of-corrected-smd" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="sampling-variance-of-corrected-smd">Sampling Variance of Corrected SMD</h4>
<p>The sampling variance can be calculated similarly to the corrected correlation. The best if the raw data is available is to compute the sampling variance from a bootstrapping procedure (see the R example on bootstrapping in the previous section on correlations). If we treat the within-group reliability as fixed (or assumed to be known <em>a priori</em>) then the corrected sampling variance is,</p>
<p><span class="math display">\[
\mathrm{var}(d_{GY}) = \frac{\mathrm{var}(d_{GY})}{r_{\widetilde{Y}\widetilde{Y}'|G}}
\]</span></p>
<p>The last option for situations where the reliability and SMD are estimated from different samples the Taylor series approximation could be applied,</p>
<p><span id="eq-se-me-d-tsa"><span class="math display">\[
\mathrm{var}(d_{GY}) = \frac{\mathrm{var}(d_{G\widetilde{Y}})}{r_{\widetilde{Y}\widetilde{Y}'|G}} +\frac{d^2_{gY}\left(1-r^2_{\widetilde{Y}\widetilde{Y}'|G}\right)^2}{4\left(1-n_{r_{\widetilde{Y}\widetilde{Y}'|G}}\right)r^3_{\widetilde{Y}\widetilde{Y}'|G}}.
\tag{6.21}\]</span></span></p>
<p>It is common that studies will only report the full sample reliability and not the reliability within each group. If the groups differ substantially on the dependent variable, <span class="math inline">\(Y\)</span>, then the total sample reliability will over-estimate the within-group reliability. When the total sample reliability is all that is available, we can correct the standardized mean difference by first converting the SMD to a point-biserial correlation. To do this we also need the observed proportion of subjects in group 0 <em>or</em> 1 (<span class="math inline">\(p_G = n_0/n\)</span> or <span class="math inline">\(p_g = n_1/n\)</span>, it does not matter which one is chosen). This three-step process is as follows:</p>
<ol type="1">
<li><p>Convert the SMD to a point-biserial correlation: <span class="math display">\[
r_{G\widetilde{Y}} = \frac{d_{G\widetilde{Y}}}{\sqrt{\frac{1}{p_G(1-p_G)} +d^2_{G\widetilde{Y}}} }
\]</span></p></li>
<li><p>Correct the point-biserial correlation: <span class="math display">\[
r_{GY} = \frac{r_{G\widetilde{Y}} }{\sqrt{r_{\widetilde{Y}\widetilde{Y}'}}}
\]</span></p></li>
<li><p>Convert back to an SMD: <span class="math display">\[
d_{GY} = \frac{r_{GY}}{\sqrt{p_G(1-p_G)(1-r^2_{GY})}}
\]</span></p></li>
</ol>
<p>With this correction procedure, the sampling variance must also go through the same three-step procedure. Treating <span class="math inline">\(a\)</span> as fixed and stuffing the three-step procedure into a single formula we get,</p>
<p><span id="eq-var-total-reliability"><span class="math display">\[
\mathrm{var}(d_{GY}) = \frac {\mathrm{var}(d_{G\widetilde{Y}}) \times\left(\frac{r_{GY}}{r_{G\widetilde{Y}}}\right)^2} {\left(1+d_{G\widetilde{Y}}^2p_G[1-p_G]\right)^3\left(1-r_{GY}^2\right)^3}.
\tag{6.22}\]</span></span></p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Applied Example in R
</div>
</div>
<div class="callout-body-container callout-body">
<p>Imagine we want to test the effectiveness of a drug that is meant to alleviate stress. Therefore we conduct a study and randomize a sample of 150 people into a control group (<span class="math inline">\(n=75\)</span>) and a treatment group (<span class="math inline">\(n=75\)</span>). After the intervention, the subjects report their stress levels on a self-report scale. The scale was shown to have a full sample reliability of <span class="math inline">\(r_{\widetilde{Y}\widetilde{Y}'}=.80\)</span>. We can correct the standardized mean differences on observed scores with the <code>correct_d</code> function in the <code>psychmeta</code> package <span class="citation" data-cites="psychmeta">(<a href="../references/references_page.html#ref-psychmeta" role="doc-biblioref">Dahlke and Wiernik 2019</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psychmeta)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># observed values</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>dGY <span class="ot">&lt;-</span> .<span class="dv">40</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>rYY <span class="ot">&lt;-</span> .<span class="dv">80</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>n0 <span class="ot">&lt;-</span> n1 <span class="ot">&lt;-</span> <span class="dv">75</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>d_correct <span class="ot">&lt;-</span> <span class="fu">correct_d</span>(<span class="at">correction =</span> <span class="st">'meas'</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">d =</span> dGY,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ryy =</span> rYY,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">n1 =</span> n0,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">n2 =</span> n1)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co"># corrected SMD</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>d_correct<span class="sc">$</span>d_values<span class="sc">$</span>dGp<span class="sc">$</span>value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4494666</code></pre>
</div>
</div>
<p>The output of psychmeta shows a slightly larger (<span class="math inline">\(d_{GY} = 0.45\)</span>). To calculate the sampling variance, we can use the <code>var_error_d()</code> function in the psychmeta package. The correction function not only gave us the corrected <span class="math inline">\(d\)</span> value but also provided the effective sample size which is adjusted for the correction procedure. The effective sample size can then be inputted as the sample size for <code>var_error_d</code>. This way the sampling variance calculation utilizes the effective sample size rather than the actual sample size which is functionally identical to <a href="#eq-var-total-reliability" class="quarto-xref">Equation&nbsp;<span>6.22</span></a>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute sampling variance of corrected SMD</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var_error_d</span>(<span class="at">d =</span> d_correct<span class="sc">$</span>d_values<span class="sc">$</span>dGp<span class="sc">$</span>value, </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">n1 =</span> d_correct<span class="sc">$</span>d_values<span class="sc">$</span>dGp<span class="sc">$</span>n_effective)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0354002</code></pre>
</div>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-bobko1980" class="csl-entry" role="listitem">
Bobko, Philip, and Angela Rieck. 1980. <span>“Large Sample Estimators for Standard Errors of Functions of Correlation Coefficients.”</span> <em>Applied Psychological Measurement</em> 4 (3): 385–98. <a href="https://doi.org/10.1177/014662168000400309">https://doi.org/10.1177/014662168000400309</a>.
</div>
<div id="ref-brown1910" class="csl-entry" role="listitem">
Brown, William. 1910. <span>“Some Experimental Results in the Correlation of Mental Abilities1.”</span> <em>British Journal of Psychology, 1904-1920</em> 3 (3): 296–322. <a href="https://doi.org/10.1111/j.2044-8295.1910.tb00207.x">https://doi.org/10.1111/j.2044-8295.1910.tb00207.x</a>.
</div>
<div id="ref-cronbach1951" class="csl-entry" role="listitem">
Cronbach, Lee J. 1951. <span>“Coefficient Alpha and the Internal Structure of Tests.”</span> <em>Psychometrika</em> 16 (3): 297–334. <a href="https://doi.org/10.1007/BF02310555">https://doi.org/10.1007/BF02310555</a>.
</div>
<div id="ref-psychmeta" class="csl-entry" role="listitem">
Dahlke, Jeffrey A., and Brenton M. Wiernik. 2019. <span>“Psychmeta: An R Package for Psychometric Meta-Analysis.”</span> <em>Applied Psychological Measurement</em> 43 (5): 415–16. <a href="https://doi.org/10.1177/0146621618795933">https://doi.org/10.1177/0146621618795933</a>.
</div>
<div id="ref-haertel2006" class="csl-entry" role="listitem">
Haertel, Edward H. 2006. <span>“3. Reliability.”</span> In, 4th ed.
</div>
<div id="ref-hunter1990a" class="csl-entry" role="listitem">
Hunter, John E., and Frank L. Schmidt. 2015. <em>Methods of meta-analysis: correcting error and bias in research findings (third)</em>. Third. Thousand Oaks, California: Sage Publications.
</div>
<div id="ref-kroc2020" class="csl-entry" role="listitem">
Kroc, Edward, and Bruno D. Zumbo. 2020. <span>“A Transdisciplinary View of Measurement Error Models and the Variations of x=t+e.”</span> <em>Journal of Mathematical Psychology</em> 98 (September): 102372. <a href="https://doi.org/10.1016/j.jmp.2020.102372">https://doi.org/10.1016/j.jmp.2020.102372</a>.
</div>
<div id="ref-kuder1937" class="csl-entry" role="listitem">
Kuder, G. F., and M. W. Richardson. 1937. <span>“The Theory of the Estimation of Test Reliability.”</span> <em>Psychometrika</em> 2 (3): 151–60. <a href="https://doi.org/10.1007/BF02288391">https://doi.org/10.1007/BF02288391</a>.
</div>
<div id="ref-missRanger" class="csl-entry" role="listitem">
Mayer, Michael. 2023. <em>missRanger: Fast Imputation of Missing Values</em>. <a href="https://CRAN.R-project.org/package=missRanger">https://CRAN.R-project.org/package=missRanger</a>.
</div>
<div id="ref-mendoza1987" class="csl-entry" role="listitem">
Mendoza, Jorge L., and Michael Mumford. 1987. <span>“Corrections for Attenuation and Range Restriction on the Predictor.”</span> <em>Journal of Educational Statistics</em> 12 (3): 282–93. <a href="https://doi.org/10.3102/10769986012003282">https://doi.org/10.3102/10769986012003282</a>.
</div>
<div id="ref-mosier1943" class="csl-entry" role="listitem">
Mosier, Charles I. 1943. <span>“On the Reliability of a Weighted Composite.”</span> <em>Psychometrika</em> 8 (3): 161–68.
</div>
<div id="ref-rulon1939" class="csl-entry" role="listitem">
Rulon, Phillip J. 1939. <span>“A Simplified Procedure for Determining the Reliability of a Test by Split-Halves.”</span> <em>Harvard Educational Review</em> 9 (1): 99–103.
</div>
<div id="ref-spearman1904" class="csl-entry" role="listitem">
Spearman, C. 1904. <span>“The Proof and Measurement of Association Between Two Things.”</span> <em>International Journal of Epidemiology</em> 39 (5): 1137–50. <a href="https://doi.org/10.1093/ije/dyq191">https://doi.org/10.1093/ije/dyq191</a>.
</div>
<div id="ref-spearman1910" class="csl-entry" role="listitem">
Spearman, Charles. 1910. <span>“Correlation Calculated from Faulty Data.”</span> <em>British Journal of Psychology</em> 3 (3): 271295. <a href="https://www.proquest.com/docview/1293688112/citation/7E133DC1091D4E47PQ/1">https://www.proquest.com/docview/1293688112/citation/7E133DC1091D4E47PQ/1</a>.
</div>
<div id="ref-viswesvaran2014" class="csl-entry" role="listitem">
Viswesvaran, Chockalingam, Deniz S. Ones, Frank L. Schmidt, Huy Le, and In-Sue Oh. 2014. <span>“Measurement Error Obfuscates Scientific Knowledge: Path to Cumulative Knowledge Requires Corrections for Unreliability and Psychometric Meta-Analyses.”</span> <em>Industrial and Organizational Psychology</em> 7 (4): 507–18. <a href="https://doi.org/10.1017/S1754942600006799">https://doi.org/10.1017/S1754942600006799</a>.
</div>
<div id="ref-psych" class="csl-entry" role="listitem">
William Revelle. 2023. <em>Psych: Procedures for Psychological, Psychometric, and Personality Research</em>. Evanston, Illinois: Northwestern University. <a href="https://CRAN.R-project.org/package=psych">https://CRAN.R-project.org/package=psych</a>.
</div>
<div id="ref-psychTools" class="csl-entry" role="listitem">
———. 2024. <em>psychTools: Tools to Accompany the ’Psych’ Package for Psychological Research</em>. Evanston, Illinois: Northwestern University. <a href="https://CRAN.R-project.org/package=psychTools">https://CRAN.R-project.org/package=psychTools</a>.
</div>
<div id="ref-zimmerman1975" class="csl-entry" role="listitem">
Zimmerman, Donald W. 1975. <span>“Probability Spaces, Hilbert Spaces, and the Axioms of Test Theory.”</span> <em>Psychometrika</em> 40 (3): 395–412. <a href="https://doi.org/10.1007/BF02291765">https://doi.org/10.1007/BF02291765</a>.
</div>
<div id="ref-zimmerman1977" class="csl-entry" role="listitem">
Zimmerman, Donald W, and Richard H Williams. 1977. <span>“Validity Coefficients and Correlated Errors in Test Theory.”</span> <em>The Journal of Experimental Education</em> 45 (3): 4–9.
</div>
</div>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../04-introduction-to-measurement-error/04-introduction-to-measurement-error.html" class="pagination-link  aria-label=" measurement="" error"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Measurement Error</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../06-misclassification/06-misclassification.html" class="pagination-link" aria-label="<span class='chapter-number'>7</span>&nbsp; <span class='chapter-title'>Group Misclassification</span>">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Group Misclassification</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>