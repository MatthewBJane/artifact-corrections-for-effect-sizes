<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Artifact Corrections for Effect Sizes - 6&nbsp; Group Misclassification</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./artificial_dichotomization.html" rel="next">
<link href="./unreliability.html" rel="prev">
<link href="./figure/favicon_book.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: white;
      }

      .quarto-title-block .quarto-title-banner {
        color: white;
      }
</style>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="twitter:title" content="Artifact Corrections for Effect Sizes - 6&nbsp; Group Misclassification">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="misclassification_files/figure-html/unnamed-chunk-4-1.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./small_samples.html">Artifact Corrections</a></li><li class="breadcrumb-item"><a href="./misclassification.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Group Misclassification</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Group Misclassification</span></h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Artifact Corrections for Effect Sizes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Greetings</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dedication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Dedication</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Effect Sizes and Notation</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Artifact Corrections</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./small_samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Small Samples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unreliability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Unreliability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./misclassification.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Group Misclassification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./artificial_dichotomization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Artificial Dichotomization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scale_coarseness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Scale Coarseness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./direct_range_restriction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Direct Selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./indirect_range_restriction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Indirect Selection</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Application to Meta-Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./metaanalysis_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Introduction to Meta-Analysis Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./artifact_correction_metaanalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Artifact Correction Meta-Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">6.1</span> Introduction</a></li>
  <li><a href="#defining-group-misclassification" id="toc-defining-group-misclassification" class="nav-link" data-scroll-target="#defining-group-misclassification"><span class="header-section-number">6.2</span> Defining Group Misclassification</a></li>
  <li><a href="#classification-reliability" id="toc-classification-reliability" class="nav-link" data-scroll-target="#classification-reliability"><span class="header-section-number">6.3</span> Classification Reliability</a></li>
  <li><a href="#calculating-classification-reliability-in-r" id="toc-calculating-classification-reliability-in-r" class="nav-link" data-scroll-target="#calculating-classification-reliability-in-r"><span class="header-section-number">6.4</span> Calculating Classification Reliability in R</a></li>
  <li><a href="#correcting-for-group-misclassification-in-standardized-mean-difference" id="toc-correcting-for-group-misclassification-in-standardized-mean-difference" class="nav-link" data-scroll-target="#correcting-for-group-misclassification-in-standardized-mean-difference"><span class="header-section-number">6.5</span> Correcting for Group Misclassification in Standardized Mean Difference</a>
  <ul class="collapse">
  <li><a href="#defining-our-estimand" id="toc-defining-our-estimand" class="nav-link" data-scroll-target="#defining-our-estimand"><span class="header-section-number">6.5.1</span> Defining our Estimand</a></li>
  <li><a href="#artifact-correction-for-standardized-mean-difference" id="toc-artifact-correction-for-standardized-mean-difference" class="nav-link" data-scroll-target="#artifact-correction-for-standardized-mean-difference"><span class="header-section-number">6.5.2</span> Artifact Correction for Standardized Mean Difference</a></li>
  </ul></li>
  <li><a href="#correcting-for-misclassification-in-r" id="toc-correcting-for-misclassification-in-r" class="nav-link" data-scroll-target="#correcting-for-misclassification-in-r"><span class="header-section-number">6.6</span> Correcting for Misclassification in R</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">6.1</span> Introduction</h2>
<p>Group misclassification describes a situation where true group membership (e.g., people with a disorder) does not perfectly match the observed group membership (e.g., people <em>diagnosed</em> with a disorder). Group misclassification can be considered a type of measurement error where instead of accounting for errors in continuous variables (i.e., unreliability), group misclassification accounts for errors in categorical variables.</p>
</section>
<section id="defining-group-misclassification" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="defining-group-misclassification"><span class="header-section-number">6.2</span> Defining Group Misclassification</h2>
<p>Misclassification can be defined as any deviations between true group membership and observed group membership. Let us imagine two arbitrary groups, group <span class="math inline">\(A\)</span> and group <span class="math inline">\(B\)</span>. In order to identify members of group <span class="math inline">\(A\)</span> and group <span class="math inline">\(B\)</span>, we have to use some measurement instrument. We can also assume this measurement instrument produces imperfect group classifications, that is, people who are actually in group <span class="math inline">\(A\)</span> are sometimes assigned group <span class="math inline">\(B\)</span> and vice versa. We can visualize the performance of the classification procedure with a contingency table between actual group membership (<span class="math inline">\(G\)</span>) and observed group membership (<span class="math inline">\(g\)</span>):</p>
<div class="columns">
<div class="column" style="width:25%;">

</div><div class="column" style="width:50%;">
<table class="table-bordered table-hover table">
<caption></caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><span class="math inline">\(G=A\)</span></th>
<th style="text-align: center;"><span class="math inline">\(G=B\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(g=A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(AA\)</span></td>
<td style="text-align: center;"><span class="math inline">\(BA\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(g=B\)</span></td>
<td style="text-align: center;"><span class="math inline">\(AB\)</span></td>
<td style="text-align: center;"><span class="math inline">\(BB\)</span></td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:25%;">

</div>
</div>
<p>We can see from the contingency table that subjects who were correctly classified, would be labeled in the cell block <span class="math inline">\(AA\)</span> or <span class="math inline">\(BB\)</span> and those who were misclassified would belong to cells <span class="math inline">\(BA\)</span> and <span class="math inline">\(AB\)</span>. Therefore we can define the proportion of individuals that are accurately classified as <span class="math inline">\(p_{\text{acc}} = P(AA) + P(BB)\)</span> whereas the proportion of people misclassified can be defined as <span class="math inline">\(p_{\text{mis}} = P(AB)+ P(BA)\)</span>. A high-quality classifier would would minimize <span class="math inline">\(p_{\text{mis}}\)</span> and maximize <span class="math inline">\(p_{\text{acc}}\)</span>. Note that the proportion of people misclassified is inversely proportional to the proportion of people accurately classified such that, <span class="math inline">\(p_{\text{mis}} = 1-p_{\text{acc}}\)</span>.</p>
</section>
<section id="classification-reliability" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="classification-reliability"><span class="header-section-number">6.3</span> Classification Reliability</h2>
<p>Similar to quantifying reliability in continuous variables by calculating the correlation in parallel sets of observed scores, the same can be done in categorical variables. Instead of a contingency table between observed (<span class="math inline">\(g\)</span>) and true (<span class="math inline">\(G\)</span>) group membership, we will instead create a contingency table of two measurements producing two sets of observed group assignments (<span class="math inline">\(g\)</span> and <span class="math inline">\(g'\)</span>). Measurements often will take the form of inter-rater assessments, for example, two clinician’s diagnosis of Major Depressive Disorder (MDD) in the same sample of patients.</p>
<div class="columns">
<div class="column" style="width:25%;">

</div><div class="column" style="width:50%;">
<table class="table-bordered table">
<caption></caption>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">\(g=A\)</span></th>
<th style="text-align: center;"><span class="math inline">\(g=B\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(g'=A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(AA\)</span></td>
<td style="text-align: center;"><span class="math inline">\(BA\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(g'=B\)</span></td>
<td style="text-align: center;"><span class="math inline">\(AB\)</span></td>
<td style="text-align: center;"><span class="math inline">\(BB\)</span></td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:25%;">

</div>
</div>
<p>To obtain the reliability of the group assignments, we can calculate the correlation coefficient between <span class="math inline">\(g\)</span> and <span class="math inline">\(g'\)</span>. Since both variables are categorical, a Pearson correlation coefficient would not be an appropriate correlation estimator, instead, we must compute the phi coefficient. The phi coefficient is often referred to as Matthew’s correlation coefficient and is most frequently used as an index of performance of a binary classifier in machine learning. For the sake of consistency, the phi coefficient will be denoted with the letter <span class="math inline">\(r\)</span>, and thus the reliability (i.e., the correlation between <span class="math inline">\(g\)</span> and <span class="math inline">\(g'\)</span>) is denoted with <span class="math inline">\(r_{gg'}\)</span>.</p>
<p>There are a few ways we can calculate the phi coefficient. The first way is to calculate phi directly from the contingency table,</p>
<p><span class="math display">\[
r_{gg'} = \frac{n_{AA}n_{BB}-n_{AB}n_{BA}}{\sqrt{(n_{AA}+n_{BA})(n_{AB}+n_{BB})(n_{AA}+n_{AB})(n_{BA}+n_{BB})}}.
\]</span></p>
<p>Where <span class="math inline">\(n_{AA}\)</span>, <span class="math inline">\(n_{BB}\)</span>, <span class="math inline">\(n_{AB}\)</span>, and <span class="math inline">\(n_{BA}\)</span> are the number of subjects within their respective cells of the contingency table. If the values of the contingency table are not available, we can calculate the phi coefficient from the <span class="math inline">\(\chi^2\)</span>-statistic,</p>
<p><span class="math display">\[
r_{gg'} = \sqrt{\frac{\chi^2}{n}}.
\]</span></p>
<p>Where <span class="math inline">\(n\)</span> is the total sample size. If the <span class="math inline">\(\chi^2\)</span>-statistic is unavailable, we can approximate the phi coefficient from the accuracy (<span class="math inline">\(p_{\text{acc}}\)</span>) or the proportion of people misclassified (<span class="math inline">\(p_{\text{mis}}\)</span>),</p>
<p><span class="math display">\[
r_{gg'} = (2p_{\text{acc}}-1)^2 = (1-2p_{\text{mis}})^2.
\]</span></p>
<p>This approximation assumes that the group sizes are approximately equal <em>and</em> the misclassification rates are approximately equal between groups. Otherwise, <span class="math inline">\(r_{gg'}\)</span> will be overestimated <span class="citation" data-cites="wiernik2020">(<a href="direct_range_restriction.html#ref-wiernik2020" role="doc-biblioref">Wiernik and Dahlke 2020</a>)</span>.</p>
<p>In the chapter 5, we discussed the relationship between reliability and the correlation between observed and true scores. The classification reliability will also be related similarly to the correlation between observed group membership and true group membership (<span class="math inline">\(r_{gG}\)</span>) such that,</p>
<p><span class="math display">\[
r_{gG}=\sqrt{r_{gg'}}.
\]</span></p>
</section>
<section id="calculating-classification-reliability-in-r" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="calculating-classification-reliability-in-r"><span class="header-section-number">6.4</span> Calculating Classification Reliability in R</h2>
<p>To calculate classification reliability we will first need data. We can simulate 100 subjects with a group value for three variables: a true group membership and two sets of assigned (observed) group membership. We will set the misclassification rate to 10%.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">17</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 10% misclassification rate</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>p_mis <span class="ot">&lt;-</span> .<span class="dv">10</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># sample size of 100</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>nA <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>nB <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> nA <span class="sc">+</span> nB</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># create a vector of true group values</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>true_A <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">'A'</span>,nA)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>true_B <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">'B'</span>,nB)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>true_group <span class="ot">&lt;-</span> <span class="fu">c</span>(true_A,true_B)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize vectors of observed group membership from true group membership</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>obs_1_A <span class="ot">&lt;-</span> true_A</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>obs_1_B <span class="ot">&lt;-</span> true_B</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>obs_2_A <span class="ot">&lt;-</span> true_A</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>obs_2_B <span class="ot">&lt;-</span> true_B</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># add misclassified values to observed group membership</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>obs_1_A[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>nA,nA<span class="sc">*</span>p_mis)] <span class="ot">&lt;-</span> <span class="st">'B'</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>obs_1_B[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>nB,nB<span class="sc">*</span>p_mis)] <span class="ot">&lt;-</span> <span class="st">'A'</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>obs_2_A[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>nA,nA<span class="sc">*</span>p_mis)] <span class="ot">&lt;-</span> <span class="st">'B'</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>obs_2_B[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>nB,nB<span class="sc">*</span>p_mis)] <span class="ot">&lt;-</span> <span class="st">'A'</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>obs_1_group <span class="ot">&lt;-</span> <span class="fu">c</span>(obs_1_A,obs_1_B)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>obs_2_group <span class="ot">&lt;-</span> <span class="fu">c</span>(obs_2_A,obs_2_B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we can generate a contingency table of the two sets of observed group assignments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create contingency table of the two observed group memberships</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>con_table <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">data.frame</span>(<span class="at">obs_1=</span>obs_1_group,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">obs_2=</span>obs_2_group))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(con_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     obs_2
obs_1  A  B
    A 40 10
    B 10 40</code></pre>
</div>
</div>
<p>Now we can calculate the reliability of the group assignments by extracting the phi coefficient from the contingency table. We can compute it by hand or by using the <code>psych</code> package by William Revelle <span class="citation" data-cites="psych:p2017">(<a href="direct_range_restriction.html#ref-psych:p2017" role="doc-biblioref">2017</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Strategy 1: Using the {psych} package</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># load in psych package (make sure it is installed first: install.packages('psych'))</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>rgg <span class="ot">=</span> <span class="fu">phi</span>(con_table,<span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Strategy 2: calculate from contingency table values</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>numerator <span class="ot">&lt;-</span> con_table[<span class="st">'A'</span>,<span class="st">'A'</span>]<span class="sc">*</span>con_table[<span class="st">'B'</span>,<span class="st">'B'</span>] <span class="sc">-</span> con_table[<span class="st">'A'</span>,<span class="st">'B'</span>]<span class="sc">*</span>con_table[<span class="st">'B'</span>,<span class="st">'A'</span>]</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>denominator <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(con_table[<span class="st">'A'</span>,<span class="st">'A'</span>]<span class="sc">+</span>con_table[<span class="st">'A'</span>,<span class="st">'B'</span>]) <span class="sc">*</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(con_table[<span class="st">'B'</span>,<span class="st">'A'</span>]<span class="sc">+</span>con_table[<span class="st">'B'</span>,<span class="st">'B'</span>]) <span class="sc">*</span> </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(con_table[<span class="st">'A'</span>,<span class="st">'A'</span>]<span class="sc">+</span>con_table[<span class="st">'B'</span>,<span class="st">'A'</span>]) <span class="sc">*</span> </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(con_table[<span class="st">'A'</span>,<span class="st">'B'</span>]<span class="sc">+</span>con_table[<span class="st">'B'</span>,<span class="st">'B'</span>])</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>rgg <span class="ot">&lt;-</span> numerator <span class="sc">/</span> denominator</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Strategy 3: calculate from chi-square test</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>chi2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">chisq.test</span>(con_table)<span class="sc">$</span>statistic)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>rgg <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(chi2<span class="sc">/</span>n)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Strategy 4: calculate from proportion of people misclassified</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>rgg <span class="ot">&lt;-</span> (<span class="dv">1-2</span><span class="sc">*</span>p_mis)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rgg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.64</code></pre>
</div>
</div>
</section>
<section id="correcting-for-group-misclassification-in-standardized-mean-difference" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="correcting-for-group-misclassification-in-standardized-mean-difference"><span class="header-section-number">6.5</span> Correcting for Group Misclassification in Standardized Mean Difference</h2>
<section id="defining-our-estimand" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1" class="anchored" data-anchor-id="defining-our-estimand"><span class="header-section-number">6.5.1</span> Defining our Estimand</h3>
<p>Our quantity of interest is the true population standardized mean difference, <span class="math inline">\(\delta\)</span>, between members of group <span class="math inline">\(A\)</span> and group <span class="math inline">\(B\)</span> on the scores of the dependent variable, <span class="math inline">\(y\)</span>. However, the observed sample standardized mean difference (<span class="math inline">\(d_o\)</span>) is estimating the difference between individuals who are assigned group to <span class="math inline">\(A\)</span> and group <span class="math inline">\(B\)</span>. Error in the assignment of groups (i.e., group misclassification) will bias the observed correlation by a factor we will label as <span class="math inline">\(a\)</span>. The relationship between the observed study standardized mean difference and the true population standardized mean difference</p>
<p><span class="math display">\[
d_o = a\delta + \varepsilon.
\]</span></p>
<p>Where <span class="math inline">\(\varepsilon\)</span> denotes the sampling error. Therefore an unbiased (corrected) estimate of the true population correlation would be:</p>
<p><span class="math display">\[
r_c = \frac{r_o}{a}.
\]</span></p>
</section>
<section id="artifact-correction-for-standardized-mean-difference" class="level3" data-number="6.5.2">
<h3 data-number="6.5.2" class="anchored" data-anchor-id="artifact-correction-for-standardized-mean-difference"><span class="header-section-number">6.5.2</span> Artifact Correction for Standardized Mean Difference</h3>
<p>The standardized mean differences will become biased when subject’s assigned groups differ from their actual group. This is largely due to the fact that the means of each group are driven closer to one another. Let us suppose that, on average, group <span class="math inline">\(A\)</span> and group <span class="math inline">\(B\)</span> score differently on some outcome, <span class="math inline">\(y\)</span>. The true mean of <span class="math inline">\(y\)</span> for groups <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> can be denoted as <span class="math inline">\(\bar{y}^\text{true}_{A}\)</span> and <span class="math inline">\(\bar{y}^\text{true}_{B}\)</span>, respectively. Nonetheless, when some subjects are erroneously assigned to the wrong group, the <em>observed</em> mean within each group will reflect a weighted average of the respective means. This is due to the fact that the misclassified individuals are being drawn from a population with a different mean. To calculate the mean of the observed groups we must incorporate the true mean of the correctly classified subjects and the misclassified subjects,</p>
<p><span class="math display">\[
\bar{y}^\text{obs}_A = \left(\frac{n_{AA}}{n_{AA}+n_{BA}}\right)\bar{y}^\text{true}_A + \left(\frac{n_{BA}}{n_{AA}+n_{BA}}\right)\bar{y}^\text{true}_B
\]</span></p>
<p><span class="math display">\[
\bar{y}^\text{obs}_A = \left(\frac{n_{BB}}{n_{BB}+n_{AB}}\right)\bar{y}^\text{true}_B + \left(\frac{n_{AB}}{n_{BB}+n_{AB}}\right)\bar{y}^\text{true}_A.
\]</span></p>
<p>From the above equations, it becomes evident that as the number of misclassified individuals increases (<span class="math inline">\(n_{AB}\)</span> and <span class="math inline">\(n_{BA}\)</span>), the observed means of each group gradually converge towards each other. As the means converge, the standardized mean difference will correspondingly shift toward zero. To illustrate this phenomenon, the figure below shows the distributions for groups <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> without any misclassification. In this case, there is no attenuation of the standardized mean difference.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="misclassification_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Distributions of scores without misclassification. True mean difference and observed mean differ only due to sampling error.</figcaption>
</figure>
</div>
</div>
</div>
<p>If some individual’s are assigned to the incorrect group, then we will see attenuation in the standardized mean difference as the means converge. Now lets display a figure showing what happens when the group misclassification rate is 10%. A group misclassification rate of 10% is equivalent to a classification reliability of <span class="math inline">\(r_{gg'}=.60\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="misclassification_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Distributions of scores with a 10% misclassification rate. Observed standardized mean differences are biased toward the null (i.e., SMD = 0). Note that a few members of group <span class="math inline">\(A\)</span> (red squares) are within observed group <span class="math inline">\(B\)</span> and vice versa (indicative of misclassification).</figcaption>
</figure>
</div>
</div>
</div>
<p>The bias in the standardized mean difference can be expressed as a function of the classification reliability (<span class="math inline">\(r_{gg'}\)</span>). To illuminate this bias, we must first convert the true SMD to a point-biserial correlation coefficient (<span class="math inline">\(\rho\)</span>) using the proportion of individuals in group <span class="math inline">\(A\)</span> (<span class="math inline">\(p_A\)</span>) and group <span class="math inline">\(B\)</span> (<span class="math inline">\(1-p\)</span>),</p>
<p><span class="math display">\[
\rho = \frac{\delta}{\sqrt{\frac{1}{p(1-p)}-\delta^2}}.
\]</span></p>
<p>Then attenuation of the correlation is similar to the attenuation of correlation coefficients in the section on unreliability (<span class="math inline">\(r = \rho\sqrt{r_{xx'}}\)</span>). However in this case, we also need to convert the point-biserial correlation to the observed standardized mean difference:</p>
<p><span class="math display">\[
\delta_o =\frac{ \rho \sqrt{r_{gg'}} }{\sqrt{p (p-1)\left(1- r_{gg'} \rho^2\right) }}.
\]</span></p>
<p>It is important to note that for many of the biasing effects and corrections, converting the standardized mean difference to a point-biserial correlation is often a necessary step. However once the corrected point-biserial correlation is obtained, the correlation can then be converted back into a standardized mean difference like we see in the last equation. To correct for bias induced by misclassification we first need to convert the observed standardized mean difference to a point-biserial correlation coefficient by using the observed proportion of the sample that has been assigned to either group <span class="math inline">\(A\)</span> or group <span class="math inline">\(B\)</span> (<span class="math inline">\(p\)</span>). The group proportion <span class="math inline">\(p\)</span> in the following equations will only show up in the term <span class="math inline">\(p(1-p)\)</span> so it will not matter which group is used. Converting <span class="math inline">\(d\)</span> to <span class="math inline">\(r\)</span>:</p>
<p><span class="math display">\[
r_o = \frac{d_o}{\sqrt{\frac{1}{p(1-p)}-d_o^2}}.
\]</span></p>
<p>We can then correct the point-biserial correlation for group misclassification with the square root of the classification reliability:</p>
<p><span class="math display">\[
r_c = \frac{r_o}{\sqrt{r_{gg'}}}.
\]</span></p>
<p>If we also wanted to correct for measurement error in the dependent variable <span class="math inline">\(y\)</span>, we can use the correction formula used in the chapter 4</p>
<p><span class="math display">\[
r_c = \frac{r_o}{\sqrt{r_{gg'}}\sqrt{r_{yy'}}}.
\]</span></p>
<p>Now we can convert the corrected point-biserial correlation into a corrected standardized mean difference (<span class="math inline">\(d_c\)</span>). When converting back to a standardized mean difference, we need to use the true group proportions, <span class="math inline">\(p^*\)</span>. Although if we are to assume equal misclassification rates between groups, then the observed proportion can be used <span class="math inline">\(p\)</span>:</p>
<p><span class="math display">\[
\hat{\delta} = \frac{r_c}{\sqrt{p^*\left(1-p^*\right)\left(1-r_c^2\right)}}
\]</span></p>
<p>The s converting to a point-biserial correlation, correcting, and converting back to a standardized mean difference. This time we will do this in a single step. Therefore the adjusted sampling variance (squared standard error) can be calculated as,</p>
<p><span class="math display">\[
\sigma^2_{\varepsilon_c} = \frac {\sigma^2_{\varepsilon_o}\left(\frac{r_c}{r_o}\right)^2} {\left(1+d_o^2p[1-p]\right)^2\left(d_o^2+\frac{1}{p(1-p)}\right)p^*(1-p^*)(1-r_c^2)^3}
\]</span></p>
<p>This can be simplified if we assume that misclassification rates are equal between groups,</p>
<p><span class="math display">\[
\sigma^2_{\varepsilon_c} = \frac {\sigma^2_{\varepsilon_o}\left(\frac{\hat{\rho}}{r}\right)^2} {\left(1+d_o^2p[1-p]\right)^3(1-r_c^2)^3}
\]</span></p>
</section>
</section>
<section id="correcting-for-misclassification-in-r" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="correcting-for-misclassification-in-r"><span class="header-section-number">6.6</span> Correcting for Misclassification in R</h2>
<p>We can correct for group misclassification in R by hand or by using the <code>psychmeta</code> package <span class="citation" data-cites="dahlke2019">(<a href="direct_range_restriction.html#ref-dahlke2019" role="doc-biblioref">Dahlke and Wiernik 2019</a>)</span>. For our correction, say we got an observed standardized mean difference of <span class="math inline">\(d = 0.50\)</span> and we calculated the classification reliability to be <span class="math inline">\(r_{gg'} = .80\)</span>. Let us also say that the observed <em>and</em> the true proportion of individuals in one of the groups is <span class="math inline">\(p=p^*=.40\)</span>, therefore the other group would be <span class="math inline">\(1-p=1-p^*=.60\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> .<span class="dv">50</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>rgg <span class="ot">=</span> .<span class="dv">70</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>nA <span class="ot">=</span> <span class="dv">40</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>nB <span class="ot">=</span> <span class="dv">60</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="using-the-psychmeta-package" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="using-the-psychmeta-package">Using the <em>psychmeta</em> package</h4>
<p>The <code>psychmeta</code> package has a function, <code>correct_d</code>, that is dedicated to correcting standardized mean differences multiple types of artifacts including group misclassification.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># step 1: install and load in psychmeta</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages{'psychmeta'}</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psychmeta)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># step 2: calculate proportion of group membership</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> nA <span class="sc">/</span> (nA <span class="sc">+</span> nB)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># p = nB / (nA + nB) # alternative calculation</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># step 3: correct d for group misclassification</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">correct_d</span>(<span class="at">d =</span> d,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">rGg =</span> <span class="fu">sqrt</span>(rgg), <span class="co"># square root of rgg = rGg</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">correction =</span> <span class="st">"meas"</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">pi =</span> p,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">pa =</span> p,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">n1 =</span> nA<span class="sc">+</span>nB,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">correct_bias =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>d Values Corrected for Measurement Error:
---------------------------------------------------------------------------------------
  value CI_LL_95 CI_UL_95   n n_effective
1 0.618    0.118     1.18 100        66.6</code></pre>
</div>
</div>
<p>The output provides the corrected standardized mean difference (<code>value</code>), the upper and lower 95% confidence intervals (<code>CI_LL_95</code> and <code>CI_UL_95</code>), the sample size (<code>n</code>), and the effective sample size (<code>n_effective</code>).</p>
</section>
<section id="correcting-by-hand" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="correcting-by-hand">Correcting by hand</h4>
<p>To calculate the corrected standardized mean difference, we can use the equations in <span class="quarto-unresolved-ref">?sec-corrections</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate point estimate</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># step 1: convert d to r</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> d <span class="sc">/</span> <span class="fu">sqrt</span>( <span class="dv">1</span><span class="sc">/</span>(p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)) <span class="sc">+</span> d<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># step 2: correct r</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">=</span> r <span class="sc">/</span> <span class="fu">sqrt</span>(rgg)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># step 3: convert r to d</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">=</span> rho <span class="sc">/</span> <span class="fu">sqrt</span>( p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>) )</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate sampling variance</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># step 1: compute sampling variance for r</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>v_d <span class="ot">=</span> (nA<span class="sc">+</span>nB)<span class="sc">/</span>(nA<span class="sc">*</span>nB) <span class="sc">+</span> d<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span>(nA<span class="sc">+</span>nB))</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co"># step 2: adjust sampling variance for correction</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>v_delta <span class="ot">=</span> (v_d <span class="sc">*</span> (rho<span class="sc">/</span>r)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> ((<span class="dv">1</span> <span class="sc">+</span> d<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">3</span> <span class="sc">*</span> p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co"># print corrected values</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">'corrected: d = '</span>,<span class="fu">round</span>(delta,<span class="dv">3</span>),<span class="st">',  var = '</span>, <span class="fu">round</span>(v_delta,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "corrected: d = 0.605,  var = 0.168"</code></pre>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-dahlke2019" class="csl-entry" role="listitem">
Dahlke, Jeffrey A., and Brenton M. Wiernik. 2019. <span>“Psychmeta: An R Package for Psychometric Meta-Analysis.”</span> <em>Applied Psychological Measurement</em> 43 (5): 415–16. <a href="https://doi.org/10.1177/0146621618795933">https://doi.org/10.1177/0146621618795933</a>.
</div>
<div id="ref-psych:p2017" class="csl-entry" role="listitem">
<span>“Psych: Procedures for Personality and Psychological Research.”</span> 2017. <a href="https://CRAN.R-project.org/package=psych">https://CRAN.R-project.org/package=psych</a>.
</div>
<div id="ref-wiernik2020" class="csl-entry" role="listitem">
Wiernik, Brenton M., and Jeffrey A. Dahlke. 2020. <span>“Obtaining Unbiased Results in Meta-Analysis: The Importance of Correcting for Statistical Artifacts.”</span> <em>Advances in Methods and Practices in Psychological Science</em> 3 (1): 94–123. <a href="https://doi.org/10.1177/2515245919885611">https://doi.org/10.1177/2515245919885611</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./unreliability.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Unreliability</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./artificial_dichotomization.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Artificial Dichotomization</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>