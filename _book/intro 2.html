<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Artifact Corrections for Effect Sizes - 3&nbsp; Effect Sizes and Artifacts</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./small_samples.html" rel="next">
<link href="./dedication.html" rel="prev">
<link href="./figure/favicon_book.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="twitter:title" content="Artifact Corrections for Effect Sizes - 3&nbsp; Effect Sizes and Artifacts">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://matthewbjane.quarto.pub/artifact-corrections-for-effect-sizes/figure/MJB_twitter.jpg">
<meta name="twitter:creator" content="@MatthewBJane">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Effect Sizes and Artifacts</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Artifact Corrections for Effect Sizes</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/MatthewBJane/artifact-corrections-for-effect-sizes/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Artifact-Corrections-for-Effect-Sizes.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Greetings</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dedication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Dedication</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Effect Sizes and Artifacts</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Artifact Corrections</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./small_samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Small Samples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unreliability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Unreliability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./misclassification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Group Misclassification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./artificial_dichotomization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Artificial Dichotomization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scale_coarseness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Scale Coarseness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./direct_range_restriction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Direct Selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./indirect_range_restriction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Indirect Selection</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Application to Meta-Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./metaanalysis_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Introduction to Meta-Analysis Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./artifact_correction_metaanalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Artifact Correction Meta-Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Conclusion</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">References</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references_page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#what-are-effect-sizes" id="toc-what-are-effect-sizes" class="nav-link active" data-scroll-target="#what-are-effect-sizes"><span class="header-section-number">3.1</span> What are Effect Sizes?</a></li>
  <li><a href="#defining-the-scientific-estimand" id="toc-defining-the-scientific-estimand" class="nav-link" data-scroll-target="#defining-the-scientific-estimand"><span class="header-section-number">3.2</span> Defining the Scientific Estimand</a></li>
  <li><a href="#effect-size-errors" id="toc-effect-size-errors" class="nav-link" data-scroll-target="#effect-size-errors"><span class="header-section-number">3.3</span> Effect Size Errors</a>
  <ul class="collapse">
  <li><a href="#random-sampling-errors" id="toc-random-sampling-errors" class="nav-link" data-scroll-target="#random-sampling-errors"><span class="header-section-number">3.3.1</span> Random (Sampling) Errors</a></li>
  <li><a href="#systematic-errors" id="toc-systematic-errors" class="nav-link" data-scroll-target="#systematic-errors"><span class="header-section-number">3.3.2</span> Systematic Errors</a></li>
  </ul></li>
  <li><a href="#modeling-observed-effect-sizes" id="toc-modeling-observed-effect-sizes" class="nav-link" data-scroll-target="#modeling-observed-effect-sizes"><span class="header-section-number">3.4</span> Modeling Observed Effect Sizes</a></li>
  <li><a href="#correcting-effect-sizes" id="toc-correcting-effect-sizes" class="nav-link" data-scroll-target="#correcting-effect-sizes"><span class="header-section-number">3.5</span> Correcting Effect Sizes</a></li>
  <li><a href="#effect-size-types" id="toc-effect-size-types" class="nav-link" data-scroll-target="#effect-size-types"><span class="header-section-number">3.6</span> Effect Size Types</a>
  <ul class="collapse">
  <li><a href="#correlations" id="toc-correlations" class="nav-link" data-scroll-target="#correlations"><span class="header-section-number">3.6.1</span> Correlations</a></li>
  <li><a href="#standardized-mean-difference" id="toc-standardized-mean-difference" class="nav-link" data-scroll-target="#standardized-mean-difference"><span class="header-section-number">3.6.2</span> Standardized Mean Difference</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Effect Sizes and Artifacts</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="what-are-effect-sizes" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="what-are-effect-sizes"><span class="header-section-number">3.1</span> What are Effect Sizes?</h2>
<p>Effect sizes are statistics that measure the magnitude of a relationship between variables. It’s important to remember that effect sizes are a valuable tool, enabling researchers to extract meaningful insights from data, rather than being the ultimate objective themselves. Effect sizes aide in researcher’s ability to draw meaningful inferences from data and therefore it is crucial that they are accurate. Correlation coefficients and standardized mean differences are two of the most common effect sizes and so they will be the primary focus of this book.</p>
</section>
<section id="defining-the-scientific-estimand" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="defining-the-scientific-estimand"><span class="header-section-number">3.2</span> Defining the Scientific Estimand</h2>
<p>It is important to clearly define the quantity that we aim to estimate (i.e., the estimand). A clearly defined estimand not only shapes our statistical analyses but also establishes a meaningful connection between empirical observations and a theoretical quantity <span class="citation" data-cites="lundberg2021">(<a href="references_page.html#ref-lundberg2021" role="doc-biblioref">Lundberg, Johnson, and Stewart 2021</a>)</span>. A study can produce effect size estimates that do not accurately reflect the target value. Inaccuracies in effect size estimates can be due to deviations between the current study’s design and the design of a technically perfect study <span class="citation" data-cites="rubin1992">(<a href="references_page.html#ref-rubin1992" role="doc-biblioref">Rubin 1992</a>)</span>. Obtaining a quality estimate of the target effect size requires that the study sample and the measured variables accurately reflect the population and variables of interest. We can illustrate this with the following example:</p>
<p>Let’s say we want to know the correlation between student motivation and stress among high-school students. Suppose we conduct a study to estimate the correlation by administering a survey to a sample of senior students at a private high school. The survey consists of two questions asking student’s to rate their level of motivation and stress on a scale of 1-10. Let’s now compare how the target population and variables differ from the study population and variables (see <a href="#tbl-target">Table&nbsp;<span>3.1</span></a>):</p>
<div id="tbl-target" class="anchored">
<table class="table">
<caption>Table&nbsp;3.1: Comparison of the target and the study.</caption>
<colgroup>
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Target</th>
<th style="text-align: center;">Study</th>
<th style="text-align: left;">Potential sources of contamination</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">POPULATION</td>
<td style="text-align: center;">High-School Students</td>
<td style="text-align: center;">Seniors High-School students</td>
<td style="text-align: left;"><strong>Range Restriction.</strong> Senior student’s at private universities may have a more narrow range of characteristics such as stress and motivation than other classes (e.g., freshmen) and schools (e.g., public).</td>
</tr>
<tr class="even">
<td style="text-align: center;">VARIABLES</td>
<td style="text-align: center;">Motivation and Stress</td>
<td style="text-align: center;">Self-report questionnaire</td>
<td style="text-align: left;"><strong>Measurement Error.</strong> The measurement of the target variables of motivation and stress likely will produce errors that do not reflect the true motivation and stress of each individual.</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="effect-size-errors" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="effect-size-errors"><span class="header-section-number">3.3</span> Effect Size Errors</h2>
<section id="random-sampling-errors" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="random-sampling-errors"><span class="header-section-number">3.3.1</span> Random (Sampling) Errors</h3>
<p>Let’s start by differentiating between a population effect size and a sample estimate. The <strong>population</strong> effect size, characterizes the effect size among all possible observations of interest. In contrast, a <strong>sample</strong> effect size is an estimate of this population value, estimated by a random sample of observations. Throughout the book, population effect sizes will be denoted with Greek letters whereas sample estimates will be denoted with an English letters.</p>
<p>The population effect size is a constant, unchanging value that remains fixed across samples. However, if we were to take a random sample from the population and estimate an effect size we would find that the sample estimate varies from sample to sample and does not exactly reflect the population value. This is due to the fact that randomly taking a subset of the population will contain inherent variability in the composition of the sample. <strong>Sampling errors</strong> describe the random deviations that we observe in effect size estimates from sample to sample <span class="citation" data-cites="barraza2019">(<a href="references_page.html#ref-barraza2019" role="doc-biblioref">Barraza et al. 2019</a>)</span>. Sampling errors are random, however we will see in the next section that not all errors are systematic. We can quantify sampling errors by the variance of the effect size estimator. The variance of an effect size estimator tends to be some function of sample size, where large samples will show less variance compared to small samples. For an illustration of sampling error, see <a href="#fig-3.1">Figure&nbsp;<span>3.1</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-3.1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="intro_files/figure-html/fig-3.1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;3.1: This figure shows the distribution of sample estimates. The blue diamonds denotes the population effect size, which stays constant across samples. The black dots denote the sample effect size estimate. The grey lines denote random sampling errors, which represent the difference between the estimates and the population value. The sampling distribution on the right shows the probability distribution of estimates across repeated samples, the width of this distribution is described by the variance of the estimator. Note the illustration shows a normally distributed estimator, but this is not a requirement.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="systematic-errors" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="systematic-errors"><span class="header-section-number">3.3.2</span> Systematic Errors</h3>
<p>Sampling errors produce random errors in effect sizes, however, we can also observe systematic errors. <strong>Systematic errors</strong> are deviations from the target population value that are consistent across samples and produce bias in effect size estimates. In other words, effect size estimates will be <em>on average</em> larger or smaller than the target population value <span class="citation" data-cites="barraza2019">(<a href="references_page.html#ref-barraza2019" role="doc-biblioref">Barraza et al. 2019</a>)</span>. Random sampling errors, on the other hand, will be larger or smaller than the target population value only by chance. <strong>Attenuation</strong> describes a type of systematic error where the effect size estimates are <em>smaller</em> than the target population value on average. <strong>Inflation</strong> on the other hand, is a type of bias that produce effect size estimates that are <em>larger</em> on average. An <strong>unbiased</strong> effect size would be one where there is no systematic errors and therefore, on average, it is equal to the population effect size. As we will see in future chapters, study artifacts such as selection effects and measurement error can produce effect sizes that contain systematic errors.</p>
<p>We can see in <a href="#fig-systematic-errors">Figure&nbsp;<span>3.2</span></a> that the sampling distribution does not become wider or smaller with systematic errors (this may occur indirectly if the sampling variance depends on the effect size itself), instead the whole sampling distribution shifts downward or upward depending on whether the effect size estimates are attenuated or inflated, respectively.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-systematic-errors" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="intro_files/figure-html/fig-systematic-errors-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;3.2: Three sampling distributions representing estimators that are unbiased, attenuated, and inflated. The blue line indicates the the location of the target population effect size, whereas the black dots show the effect size estimates.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="modeling-observed-effect-sizes" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="modeling-observed-effect-sizes"><span class="header-section-number">3.4</span> Modeling Observed Effect Sizes</h2>
<p>We can think of an observed effect size estimate as having three components:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">flowchart TD
   E("observed effect &lt;br&gt;size estimate"):::estimates --- X("systematic &lt;br&gt;error (bias)"):::artifacts
   E:::estimates --- Z("target population&lt;br&gt;effect size (estimand)"):::target
   E:::estimates --- Y("random (sampling)&lt;br&gt;error"):::sampling
   classDef artifacts fill:#d74ea250,stroke-width:0px
   classDef sampling fill:#00000020,stroke-width:0px
   classDef target fill:#5fa6bc55,stroke-width:0px
   classDef estimates fill:#ffffff00,stroke-width:0px
   linkStyle default stroke-width:2px,fill:none,stroke:black;

</pre>
</div>
</div>
</div>
</div>
<p>Let’s construct a statistical model for an observed effect size estimate <span class="math inline">\(h_i\)</span> for a given sample, <span class="math inline">\(i\)</span>, that accounts for each of these three components. The <span style="color: #347e9f"><strong>target population effect size</strong></span> will be denoted by the Greek letter <span style="color: #347e9f"><span class="math inline">\(\theta\)</span></span> which does not vary from sample to sample. The <span style="color: #cb427b"><strong>artifact attenuation/inflation factor</strong></span> is denoted with the Greek letter <span style="color: #cb427b"><span class="math inline">\(\alpha\)</span></span> and accounts for the systematic error that is consistent across samples. Finally the <span style="color:#777777"><strong>sample error</strong></span> is denoted by the Greek letter <span style="color:#777777"><span class="math inline">\(\varepsilon\)</span></span> which accounts for the random sampling error across samples <span class="citation" data-cites="raju1991">(<a href="references_page.html#ref-raju1991" role="doc-biblioref">Raju et al. 1991</a>, based on eq. 1)</span>,</p>
<p><span id="eq-model"><span class="math display">\[
h_i = {\color{#cb427b}\alpha} {\color{#347e9f}\theta} +
{\color{#797979ff}\varepsilon}_i.
\tag{3.1}\]</span></span></p>
<p>Note that <span class="math inline">\({\color{#cb427b}\alpha}\)</span> and <span class="math inline">\({\color{#347e9f}\theta}\)</span> are fixed and does not vary across samples (no subscript <span class="math inline">\(i\)</span>), wheras <span class="math inline">\({\color{#797979ff}\varepsilon}_i\)</span> does vary from sample to sample. For the above equation to be true we need to assume that the expectation (i.e., the mean over repeated samples) of <span class="math inline">\({\color{#797979ff}\varepsilon}_i\)</span> is zero such that, <span class="math inline">\(\mathbb{E}[{\color{#797979ff}\varepsilon}_i] = 0\)</span>. A consequence of this assumption is that the expectation of the observed effect size estimate is <span class="math inline">\(\mathbb{E}[h_i]={\color{#cb427b}\alpha} {\color{#347e9f}\theta}\)</span>. We will label the term <span class="math inline">\({\color{#cb427b}\alpha} {\color{#347e9f}\theta}\)</span> as the <strong>contaminated population effect size</strong> as it is a fixed value that encompasses the target effect size and systematic error.</p>
<p>The artifact attenuation/inflation factor, <span class="math inline">\({\color{#cb427b}\alpha}\)</span>, completely describes the net systematic error in the observed effect size estimates. The value of <span class="math inline">\(\alpha\)</span> can indicate whether <span class="math inline">\(h_i\)</span> is an unbiased (<span class="math inline">\({\color{#cb427b}\alpha} = 0\)</span>), attenuated (<span class="math inline">\({\color{#cb427b}\alpha} &lt; 1\)</span>), or inflated estimator (<span class="math inline">\({\color{#cb427b}\alpha} &gt; 1\)</span>).</p>
<p>Because of random sampling error, the observed effect size estimate will differ from sample to sample (<span class="math inline">\(h_1\neq\)</span> <span class="math inline">\(h_2\neq\)</span> <span class="math inline">\(h_3\neq...\)</span>). The extent to which estimates fluctuate across samples can be quantified by the variance of the effect size estimator, denoted as <span class="math inline">\(\text{var}(h_i)\)</span>. Remember that the contaminated population effect size (<span class="math inline">\({\color{#cb427b}\alpha} {\color{#347e9f}\theta}\)</span>) fixed across samples, this would result in variation in random sampling errors to be solely responsible for the variation in observed effect sizes such that, <span class="math inline">\(\text{var}(h_i)=\text{var}({\color{#797979ff}\varepsilon}_i)\)</span>.</p>
</section>
<section id="correcting-effect-sizes" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="correcting-effect-sizes"><span class="header-section-number">3.5</span> Correcting Effect Sizes</h2>
<p>In principle, if we know the value of the artifact attenuation/inflation factor <span class="math inline">\({\color{#cb427b}\alpha}\)</span> then we could correct the observed effect size for systematic errors. However, <span class="math inline">\({\color{#cb427b}\alpha}\)</span> is unknown and must be estimated. An estimate of <span class="math inline">\({\color{#cb427b}\alpha}\)</span> will be denoted by the English letter <span class="math inline">\({\color{#cb427b}a}\)</span>. According to the model described in <a href="#eq-model">Equation&nbsp;<span>3.1</span></a>, <span class="math inline">\({\color{#cb427b}\alpha}\)</span> is a fixed value that does not vary from sample to sample, however it’s sample estimate will:</p>
<p><span id="eq-a"><span class="math display">\[
{\color{#cb427b}a}_i = {\color{#cb427b}\alpha} + {\color{#797979ff}\xi}_i,
\tag{3.2}\]</span></span></p>
<p>where <span class="math inline">\({\color{#797979ff}\xi}_i\)</span> denotes the sampling error in <span class="math inline">\({\color{#cb427b}a}_i\)</span>. The corrected effect size can thus be calculated by dividing the observed effect size by the estimated artifact factor,</p>
<p><span id="eq-correction"><span class="math display">\[
{\color{#347e9f}h_c}_{_i} = \frac{h_i}{{\color{#cb427b}a}_i},
\tag{3.3}\]</span></span></p>
<p>The corrected effect size will only be an asymptotically (as the sample size approaches infinity) unbiased estimator of the target population value. As we will see in future chapters, corrections will also impose additional distributional assumptions on the data.</p>
<p>Sampling variance of the corrected effect size will depend greatly on the estimation procedure of the effect size and the artifact factor. Sampling variance for corrected effect sizes will be discussed in more detail for each artifact correction chapter.</p>
</section>
<section id="effect-size-types" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="effect-size-types"><span class="header-section-number">3.6</span> Effect Size Types</h2>
<p>Although there are many types of effect sizes we can use to quantify research findings, we will primarily focus on two: correlations and standardized mean differences (SMD).</p>
<section id="correlations" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="correlations"><span class="header-section-number">3.6.1</span> Correlations</h3>
<p>A correlation describes the relationship between two continuous variables. The population correlation (<span class="math inline">\(\rho\)</span>) between variables, <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, can be defined as the covariance (<span class="math inline">\(\sigma_{XY}\)</span>) divided by the product of the standard deviations of <span class="math inline">\(X\)</span> (<span class="math inline">\(\sigma_{X}\)</span>) and <span class="math inline">\(Y\)</span> (<span class="math inline">\(\sigma_{Y}\)</span>) <span class="citation" data-cites="thehand2009 jacobs2017">(<a href="references_page.html#ref-thehand2009" role="doc-biblioref">Cooper, Hedges, and Valentine 2009</a>, equation 11.21; <a href="references_page.html#ref-jacobs2017" role="doc-biblioref">Jacobs and Viechtbauer 2017</a>, eq. 1)</span>,</p>
<p><span id="eq-pop-r"><span class="math display">\[
\rho = \frac{\sigma_{XY}}{\sigma_{X}\sigma_{Y}}.
\tag{3.4}\]</span></span></p>
<p>A sample estimate of the population correlation can be defined as the <em>sample</em> covariance (<span class="math inline">\(S_{XY}\)</span>) divided by the product of the <em>sample</em> standard deviations <span class="citation" data-cites="jacobs2017">(<a href="references_page.html#ref-jacobs2017" role="doc-biblioref">Jacobs and Viechtbauer 2017</a>, eq. 2)</span>,</p>
<p><span id="eq-sam-r"><span class="math display">\[
r = \frac{S_{XY}}{S_XS_Y}
\tag{3.5}\]</span></span></p>
<p>This is commonly referred to as the Pearson correlation coefficient. The Pearson correlation coefficient was first introduced by Auguste <span class="citation" data-cites="bravais1844">Bravais (<a href="references_page.html#ref-bravais1844" role="doc-biblioref">1844</a>)</span>, then later developed further by Karl Pearson, lending itself to the name. See <a href="#fig-r">Figure&nbsp;<span>3.3</span></a> for a visualization of correlated variables.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-r" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="intro_files/figure-html/fig-r-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;3.3: Diagram illustrating a correlation between two variables (<span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>). The left panel shows a negative correlation and the right panel shows a positive correlation. The ellipses show the contour of a bivariate normal distribution which the data points are sampled from.</figcaption>
</figure>
</div>
</div>
</div>
<p>Assuming that the variables follow a bivariate normal distribution, the asymptotic variance in an observed correlation with <span class="math inline">\(n\)</span> observations is <span class="citation" data-cites="pearson1898 jacobs2017">(<a href="references_page.html#ref-pearson1898" role="doc-biblioref">Pearson and Filon 1898, 174</a>; <a href="references_page.html#ref-jacobs2017" role="doc-biblioref">Jacobs and Viechtbauer 2017</a>, eq. 9)</span>,</p>
<p><span id="eq-asymp-var-r"><span class="math display">\[
\text{var}(r_i) \overset{_\infty}{=} \frac{\left(1 - \rho^2\right)^2}{n},
\tag{3.6}\]</span></span></p>
<p>Since the population correlation is unavailable in practice, an accurate estimate of the variance for a given sample <span class="math inline">\(i\)</span> uses the sample correlation instead of population correlation and uses the degrees of freedom, <span class="math inline">\(n-1\)</span>, in the denominator instead of the sample size <span class="citation" data-cites="thehand2009 jacobs2017">(<a href="references_page.html#ref-thehand2009" role="doc-biblioref">Cooper, Hedges, and Valentine 2009</a>, eq. 12.27; <a href="references_page.html#ref-jacobs2017" role="doc-biblioref">Jacobs and Viechtbauer 2017</a>, eq. 10)</span>,</p>
<p><span id="eq-est-var-r"><span class="math display">\[
\widehat{\text{var}}(r_i) = \frac{\left(1 - r_i^2\right)^2}{n-1}
\tag{3.7}\]</span></span></p>
<p>Within the context of a research study that is contaminated with artifacts, we can model an observed correlation for a sample <span class="math inline">\(i\)</span> as similarly to an <a href="#eq-model">Equation&nbsp;<span>3.1</span></a>,</p>
<p><span id="eq-model-r"><span class="math display">\[
r_i = {\color{#cb427b}\alpha} {\color{#347e9f}\rho} +
{\color{#797979ff}\varepsilon}_i.
\tag{3.8}\]</span></span></p>
<p>Where <span class="math inline">\({\color{#347e9f}\rho}\)</span> is the <span style="color:#347e9f">target population correlation (the estimand)</span>, <span class="math inline">\({\color{#cb427b}\alpha}\)</span> is the <span style="color:#cb427b">artifact attenuation/inflation factor</span>, and <span class="math inline">\({\color{#797979ff}\varepsilon}_i\)</span> denotes the <span style="color:#797979ff">sampling errors</span>. The observed correlation is biased relative to the target population correlation as a function of <span class="math inline">\({\color{#cb427b}\alpha}\)</span>, and therefore a corrected correlation can calculated by,</p>
<p><span id="eq-corr-r"><span class="math display">\[
{\color{#347e9f}r_c}_{_i} = \frac{r_i}{{\color{#cb427b}a}_i}.
\tag{3.9}\]</span></span></p>
<p>For example, we will see in <a href="artificial_dichotomization.html"><span>Chapter&nbsp;7</span></a> that if <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are bivariate normal and <span class="math inline">\(X\)</span> undergoes dichotomization through a median split (i.e., dividing observations into two groups based on the median of <span class="math inline">\(X\)</span>) the observed correlation will be attenuated. In this scenario, the artifact attenuation/inflation factor is <span class="math inline">\({\color{#cb427b}a} = 2/\sqrt{2\pi} \approx .80\)</span>, and therefore if the observed correlation is <span class="math inline">\(r = .40\)</span> then the corrected correlation would be estimated as <span class="math inline">\(r_c=r/{\color{#cb427b}a}=.40/.80=.50\)</span>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Computing Correlations in R
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let’s load in the <code>iris</code> data set that contains various physical measurements of three species of plants. We can also subset the data set to only look at the Setosa species:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load in data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"iris"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># subset rows to only include setosa species</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">subset</span>(iris, iris<span class="sc">$</span>species <span class="sc">==</span> <span class="st">'setosa'</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># view first 6 plants</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
</div>
<p>Let’s say we want to know the correlation between petal length and sepal length. We can use the <code>cor()</code> function in base R to obtain the Pearson correlation coefficient:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">cor</span>(iris<span class="sc">$</span>Petal.Length,iris<span class="sc">$</span>Sepal.Length)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>r</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8717538</code></pre>
</div>
</div>
<p>The result shows a strong positive correlation between petal and sepal length (<span class="math inline">\(r = .87\)</span>). To compute the sampling variance and the standard error, we can use the <code>var_error_r()</code> function in the <code>psychmeta</code> package <span class="citation" data-cites="dahlke2019">(<a href="references_page.html#ref-dahlke2019" role="doc-biblioref">Dahlke and Wiernik 2019</a>)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load in package</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psychmeta)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compute sampling variance</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>var_r <span class="ot">&lt;-</span> <span class="fu">var_error_r</span>(r, <span class="at">n =</span> <span class="fu">nrow</span>(iris), <span class="at">correct_bias =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(r,var_r) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          r        var_r
1 0.8717538 0.0003867233</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="standardized-mean-difference" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="standardized-mean-difference"><span class="header-section-number">3.6.2</span> Standardized Mean Difference</h3>
<p>The standardized mean differences (SMD) is used to quantify the difference between the average value between two groups. In the population, the SMD (<span class="math inline">\(\delta\)</span>), the difference between the mean of group <span class="math inline">\(A\)</span> (<span class="math inline">\(\mu_A\)</span>) and group <span class="math inline">\(B\)</span> (<span class="math inline">\(\mu_B\)</span>) is standardized by the population within group standard deviation (<span class="math inline">\(\sigma\)</span>) <span class="citation" data-cites="cohen1988">(<a href="references_page.html#ref-cohen1988" role="doc-biblioref">Cohen 1988</a>, eq. 2.2.1)</span>,</p>
<p><span id="eq-delta"><span class="math display">\[
\delta = \frac{\mu_A - \mu_B}{\sigma}.
\tag{3.10}\]</span></span></p>
<p>Dividing by the population within-group standard deviation assumes that the standard deviations within both groups are fixed and equal (i.e., <span class="math inline">\(\sigma=\sigma_A=\sigma_B\)</span>). For a visualization of an SMD see <a href="#fig-d">Figure&nbsp;<span>3.4</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-d" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="intro_files/figure-html/fig-d-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;3.4: Diagram illustrating a standardized mean difference in the population between two normal distributions. The mean and standard deviation of group <span class="math inline">\(A\)</span> is <span class="math inline">\(\mu_A=9\)</span> and <span class="math inline">\(\sigma_A=4\)</span>, respectively. Whereas mean and standard deviation of group <span class="math inline">\(B\)</span> is <span class="math inline">\(\mu_A=12\)</span> and <span class="math inline">\(\sigma_A=4\)</span>, respectively. Therefore the standardized mean difference is <span class="math inline">\(\delta = (9-12)/4=-.75\)</span>. Note that <span class="math inline">\(\sigma_A=\sigma_B\)</span>.</figcaption>
</figure>
</div>
</div>
</div>
<p><span class="citation" data-cites="cohen1988">Cohen (<a href="references_page.html#ref-cohen1988" role="doc-biblioref">1988</a>)</span> developed a sample estimator of <span class="math inline">\(\delta\)</span> that is commonly referred to as Cohen’s <span class="math inline">\(d\)</span>. Within a sample, we can estimate <span class="math inline">\(\delta\)</span> with the sample estimator <span class="citation" data-cites="thehand2009">(<a href="references_page.html#ref-thehand2009" role="doc-biblioref">Cooper, Hedges, and Valentine 2009</a>, eq. 11.96)</span>,</p>
<p><span id="eq-d"><span class="math display">\[
d = \frac{\overline{Y}_A-\overline{Y}_B}{S_p},
\tag{3.11}\]</span></span></p>
<p>where <span class="math inline">\(S_p\)</span> is the pooled sample standard deviation and the bars indicate the sample mean. The pooled standard deviation computes a weighted average (weighted by the within-group degrees of freedom, e.g., <span class="math inline">\(n_{A}-1\)</span>) of the within-group sample variance and then takes the square root <span class="citation" data-cites="thehand2009">(<a href="references_page.html#ref-thehand2009" role="doc-biblioref">Cooper, Hedges, and Valentine 2009</a>, eq. 12.12)</span>,</p>
<p><span id="eq-pooled-sd"><span class="math display">\[
S_p = \sqrt{\frac{(n_A-1)S_A^2 + (n_B-1)S_B^2}{n-2}}
\tag{3.12}\]</span></span></p>
<p>Where <span class="math inline">\(n_A\)</span>, <span class="math inline">\(n_B\)</span>, and <span class="math inline">\(n\)</span> represent the sample size within group <span class="math inline">\(A\)</span>, group <span class="math inline">\(B\)</span>, and the total sample size (<span class="math inline">\(n = n_A+n_B\)</span>), respectively. Assuming that <span class="math inline">\(Y\)</span> is normally distributed within each group and the within-group variances are equal, the asymptotic sampling variance of an SMD is <span class="citation" data-cites="hedges1985">(<a href="references_page.html#ref-hedges1985" role="doc-biblioref">Hedges and Olkin 1985</a>, eq. 14)</span>,</p>
<p><span id="eq-var-d"><span class="math display">\[
\text{var}(d_i) \overset{_\infty}{=} \frac{n}{n_An_B} + \frac{\delta^2}{2n}.
\tag{3.13}\]</span></span></p>
<p>Since the population SMD is unknown, we can estimate it with the sample <span class="math inline">\(d\)</span> value. Therefore the estimated variance can be computed as <span class="citation" data-cites="hunter1990a">(<a href="references_page.html#ref-hunter1990a" role="doc-biblioref">Hunter and Schmidt 2015</a>, eq. 7.23)</span>,</p>
<p><span id="eq-var-d-est"><span class="math display">\[
\widehat{\text{var}}(d_i) = \left(\frac{n - 1}{n - 3}\right)\left(\frac{n}{n_An_B} + \frac{\delta^2}{2n}\right).
\tag{3.14}\]</span></span></p>
<p>Note that the multiplier, <span class="math inline">\((n_A+n_B - 1)/(n_A+n_B - 3)\)</span>, is to account for slight underestimation of the sampling variance in small sample sizes <span class="citation" data-cites="goulet-pelletier2018">(<a href="references_page.html#ref-goulet-pelletier2018" role="doc-biblioref">Goulet-Pelletier and Cousineau 2018</a>)</span>.</p>
<p>In a study contaminated by artifacts, we can model an observed SMD for a sample <span class="math inline">\(i\)</span> as similarly to an <a href="#eq-model">Equation&nbsp;<span>3.1</span></a>,</p>
<p><span id="eq-model-d"><span class="math display">\[
d_i = {\color{#cb427b}\alpha} {\color{#347e9f}\delta} +
{\color{#797979ff}\varepsilon}_i.
\tag{3.15}\]</span></span></p>
<p>Where <span class="math inline">\({\color{#347e9f}\delta}\)</span> is the <span style="color:#347e9f">target population SMD (the estimand)</span>, <span class="math inline">\({\color{#cb427b}\alpha}\)</span> is the <span style="color:#cb427b">artifact attenuation/inflation factor</span>, and <span class="math inline">\({\color{#797979ff}\varepsilon}_i\)</span> denotes the <span style="color:#797979ff">sampling errors</span>. The observed SMD is biased relative to the target population SMD as a function of <span class="math inline">\({\color{#cb427b}\alpha}\)</span>. However, <span class="math inline">\({\color{#cb427b}\alpha}\)</span> is not available in practice and so therefore the observed SMD can be corrected by dividing by an estimate of <span class="math inline">\({\color{#cb427b}\alpha}\)</span>,</p>
<p><span id="eq-corr-d"><span class="math display">\[
{\color{#347e9f}d_c}_{_i} = \frac{d_i}{{\color{#cb427b}a}_i}.
\tag{3.16}\]</span></span></p>
<p>Occasionally, corrections can not be applied to the contaminated <span class="math inline">\(d\)</span> value directly. In such cases, we may have to correct <span class="math inline">\(d\)</span> by first converting to a <em>point-biserial</em> correlation (i.e., a Pearson correlation between a dichotomous group variable and continuous variable), correcting the correlation, and then converting back to a (corrected) <span class="math inline">\(d\)</span> value <span class="citation" data-cites="hunter1990a">(<a href="references_page.html#ref-hunter1990a" role="doc-biblioref">Hunter and Schmidt 2015</a>)</span>. The three-step procedure can be applied as follows:</p>
<ol type="1">
<li>Convert <span class="math inline">\(d\)</span> to <span class="math inline">\(r\)</span> using the proportion of subjects in group <span class="math inline">\(A\)</span> or group <span class="math inline">\(B\)</span> (<span class="math inline">\(p=n_A/n\)</span> or <span class="math inline">\(p=n_B/n\)</span>) <span class="citation" data-cites="wiernik2020">(<a href="references_page.html#ref-wiernik2020" role="doc-biblioref">Wiernik and Dahlke 2020</a>, equation 9)</span>,</li>
</ol>
<p><span id="eq-three-step-1"><span class="math display">\[
r_i = \frac{d_i}{\sqrt{\frac{1}{p_i(1-p_i)}+d_i}}.
\tag{3.17}\]</span></span></p>
<ol start="2" type="1">
<li>Correct the point-biserial correlation,</li>
</ol>
<p><span class="math display">\[
{\color{#347e9f}r_c}_{_i} = \frac{r_i}{{\color{#cb427b}a}_i}.
\]</span></p>
<ol start="3" type="1">
<li>Convert <span class="math inline">\(r_c\)</span> back to a <span class="math inline">\(d\)</span> value. If the proportions of group membership are contaminated by artifacts, then we need the true group proportions in the target population (<span class="math inline">\(p_i^*\)</span>) to convert back to <span class="math inline">\(d\)</span>. If the the true group proportions are unavailable, then we can use the observed proportions as estimates <span class="citation" data-cites="wiernik2020">(<a href="references_page.html#ref-wiernik2020" role="doc-biblioref">Wiernik and Dahlke 2020</a>, equation 10)</span></li>
</ol>
<p><span id="eq-three-step-3"><span class="math display">\[
{\color{#347e9f}d_c}_{_i} =  \frac{{\color{#347e9f}r}_{{\color{#347e9f}c}_i}}{\sqrt{p_i^*(1-p_i^*)(1-{\color{#347e9f}r}_{{\color{#347e9f}c}_i}^2)}} \approx \frac{{\color{#347e9f}r}_{{\color{#347e9f}c}_i}}{\sqrt{p_i(1-p_i)(1-{\color{#347e9f}r}_{{\color{#347e9f}c}_i}^2)}}.
\tag{3.18}\]</span></span></p>
<p>The sampling variance of the corrected SMD can be quite complicated when there is sampling error in the artifact factor.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Computing SMDs in R
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let’s load in a data set for a plant growth experiment:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load in data</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"PlantGrowth"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># view first 6 plants</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(PlantGrowth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  weight group
1   4.17  ctrl
2   5.58  ctrl
3   5.18  ctrl
4   6.11  ctrl
5   4.50  ctrl
6   4.61  ctrl</code></pre>
</div>
</div>
<p>We see that the data set contains two variables, weight of the plant and the experimental group. There are three two experimental groups present: a control group and two treatment groups. If we want to obtain the SMD between the each treatment group and the control group, we can use the <code>cohen.d</code> function <code>psych</code> package <span class="citation" data-cites="psych">(<a href="references_page.html#ref-psych" role="doc-biblioref">William Revelle 2023</a>)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate SMD for first treatment group</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">cohen.d</span>(weight <span class="sc">~</span> group,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> <span class="fu">subset</span>(PlantGrowth, group <span class="sc">==</span> <span class="st">'ctrl'</span> <span class="sc">|</span> group <span class="sc">==</span> <span class="st">'trt1'</span>))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>d1<span class="sc">$</span>cohen.d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          lower     effect     upper
weight -1.44938 -0.5615655 0.3411078</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate SMD for first treatment group</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">cohen.d</span>(weight <span class="sc">~</span> group,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> <span class="fu">subset</span>(PlantGrowth, group <span class="sc">==</span> <span class="st">'ctrl'</span> <span class="sc">|</span> group <span class="sc">==</span> <span class="st">'trt2'</span>))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>d2<span class="sc">$</span>cohen.d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            lower   effect    upper
weight 0.05850126 1.005987 1.929048</code></pre>
</div>
</div>
<p>We see that the first treatment showed a negative effect on plant growth (<span class="math inline">\(d=-0.56\)</span>) and the second treatment shows a positive effect (<span class="math inline">\(d=1.01\)</span>). For our purposes we want the estimate and the sampling variance of the estimator, therefore we can extract that information from the output of <code>cohen.d()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">d =</span> d1<span class="sc">$</span>cohen.d[,<span class="st">'effect'</span>], </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">var.d =</span> d1<span class="sc">$</span>se<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           d     var.d
1 -0.5615655 0.8014621</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">d =</span> d2<span class="sc">$</span>cohen.d[,<span class="st">'effect'</span>], </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">var.d =</span> d2<span class="sc">$</span>se<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         d     var.d
1 1.005987 0.8747367</code></pre>
</div>
</div>
</div>
</div>
<!-- 1.  Convert $\widehat{\text{var}}(d_i)$ to $\widehat{\text{var}}(r_i)$, -->
<!-- $$ -->
<!-- \widehat{\text{var}}(r_i) = \frac{\widehat{\text{var}}(d_i)}{\left(1+d^2_i p_i\left[1-p_i\right]\right)^2\left(d_i^2+\frac{1}{p_i(1-p_i)}\right)}. -->
<!-- $$ -->
<!-- 2.  Estimate the sampling variance of the corrected point-biserial correlation, -->
<!-- $$ -->
<!-- \widehat{\text{var}}(r_{c_i}) = \frac{\widehat{\text{var}}(r_i)}{\alpha^2} = \frac{\widehat{\text{var}}(r_i)}{\left(\frac{r_i}{r_{c_i}}\right)^2}. -->
<!-- $$ -->
<!-- 3.  Then convert the sampling variance of $r_c$ back to the sampling variance of a $d$ value, -->
<!-- $$ -->
<!-- \widehat{\text{var}}(d_{c_i}) = \frac{\widehat{\text{var}}(r_{c_i})}{p^*_i\left(1-p^*_i\right)\left(1-r_{c_i}^2\right)^3}. -->
<!-- $$ -->
<!-- Alternatively, we can squeeze the three-step procedure into a single equation [@wiernik2020, equation 28], -->
<!-- $$ -->
<!-- \widehat{\text{var}}(d_{c_i}) = \frac{\widehat{\text{var}}(d_i)\left(\frac{r_{c_i}}{r_{i}}\right)^2}{\left(1+d^2_i p_i\left[1-p_i\right]\right)^2\left(d_i^2+\frac{1}{p_i(1-p_i)}\right)p^*_i\left(1-p^*_i\right)\left(1-r_{c_i}^2\right)^3} -->
<!-- $$ -->
<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="matthewbjane" data-description="Support me by buying me a coffee!" data-message="Thank you for being here! You can support this work." data-color="#eeb4d7ff" data-position="Right" data-x_margin="18" data-y_margin="18"></script>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-barraza2019" class="csl-entry" role="listitem">
Barraza, Felipe, Marcelo Arancibia, Eva Madrid, and Cristian Papuzinski. 2019. <span>“General Concepts in Biostatistics and Clinical Epidemiology: Random Error and Systematic Error.”</span> <em>Medwave</em> 19 (7): e7687. <a href="https://doi.org/10.5867/medwave.2019.07.7687">https://doi.org/10.5867/medwave.2019.07.7687</a>.
</div>
<div id="ref-bravais1844" class="csl-entry" role="listitem">
Bravais, A. 1844. <em>Analyse mathématique sur les probabilités des erreurs de situation d’un point</em>. Impr. Royale.
</div>
<div id="ref-cohen1988" class="csl-entry" role="listitem">
Cohen, Jacob. 1988. <em>Statistical Power Analysis for the Behavioral Sciences</em>. Academic Press.
</div>
<div id="ref-thehand2009" class="csl-entry" role="listitem">
Cooper, Harris M., Larry V. Hedges, and Jeff C. Valentine, eds. 2009. <em>The Handbook of Research Synthesis and Meta-Analysis</em>. 2nd ed. New York: Russell Sage Foundation.
</div>
<div id="ref-dahlke2019" class="csl-entry" role="listitem">
Dahlke, Jeffrey A., and Brenton M. Wiernik. 2019. <span>“Psychmeta: An R Package for Psychometric Meta-Analysis.”</span> <em>Applied Psychological Measurement</em> 43 (5): 415–16. <a href="https://doi.org/10.1177/0146621618795933">https://doi.org/10.1177/0146621618795933</a>.
</div>
<div id="ref-goulet-pelletier2018" class="csl-entry" role="listitem">
Goulet-Pelletier, Jean-Christophe, and Denis Cousineau. 2018. <span>“A Review of Effect Sizes and Their Confidence Intervals, Part i: The Cohen<span>’</span>s d Family.”</span> <em>The Quantitative Methods for Psychology</em> 14 (4): 242–65. <a href="https://doi.org/10.20982/tqmp.14.4.p242">https://doi.org/10.20982/tqmp.14.4.p242</a>.
</div>
<div id="ref-hedges1985" class="csl-entry" role="listitem">
Hedges, Larry V., and Ingram Olkin. 1985. <em>Statistical Methods for Meta-Analysis</em>. Academic press. <a href="https://books.google.com/books?hl=en&amp;lr=&amp;id=7GviBQAAQBAJ&amp;oi=fnd&amp;pg=PP1&amp;dq=info:e6P1zfh2T6QJ:scholar.google.com&amp;ots=Dx-YqN6_9B&amp;sig=-39HgbYdWPp_BwSTzA9cRODs2Q0">https://books.google.com/books?hl=en&amp;lr=&amp;id=7GviBQAAQBAJ&amp;oi=fnd&amp;pg=PP1&amp;dq=info:e6P1zfh2T6QJ:scholar.google.com&amp;ots=Dx-YqN6_9B&amp;sig=-39HgbYdWPp_BwSTzA9cRODs2Q0</a>.
</div>
<div id="ref-hunter1990a" class="csl-entry" role="listitem">
Hunter, John E., and Frank L. Schmidt. 2015. <em>Methods of meta-analysis: correcting error and bias in research findings (third)</em>. Third. Thousand Oaks, California: Sage Publications.
</div>
<div id="ref-jacobs2017" class="csl-entry" role="listitem">
Jacobs, Perke, and Wolfgang Viechtbauer. 2017. <span>“Estimation of the Biserial Correlation and Its Sampling Variance for Use in Meta-Analysis.”</span> <em>Research Synthesis Methods</em> 8 (2): 161–80. <a href="https://doi.org/10.1002/jrsm.1218">https://doi.org/10.1002/jrsm.1218</a>.
</div>
<div id="ref-lundberg2021" class="csl-entry" role="listitem">
Lundberg, Ian, Rebecca Johnson, and Brandon M. Stewart. 2021. <span>“What Is Your Estimand? Defining the Target Quantity Connects Statistical Evidence to Theory.”</span> <em>American Sociological Review</em> 86 (3): 532–65. <a href="https://doi.org/10.1177/00031224211004187">https://doi.org/10.1177/00031224211004187</a>.
</div>
<div id="ref-pearson1898" class="csl-entry" role="listitem">
Pearson, Karl, and L. N. G. Filon. 1898. <span>“Mathematical Contributions to the Theory of Evolution. IV. On the Probable Errors of Frequency Constants and on the Influence of Random Selection on Variation and Correlation. [Abstract].”</span> <em>Proceedings of the Royal Society of London</em> 62: 173–76. <a href="https://www.jstor.org/stable/115709">https://www.jstor.org/stable/115709</a>.
</div>
<div id="ref-raju1991" class="csl-entry" role="listitem">
Raju, Nambury, Michael Burke, Jacques Normand, and George Langlois. 1991. <span>“A New Meta-Analytic Approach.”</span> <em>Journal of Applied Psychology</em> 76 (June): 432–46. <a href="https://doi.org/10.1037/0021-9010.76.3.432">https://doi.org/10.1037/0021-9010.76.3.432</a>.
</div>
<div id="ref-rubin1992" class="csl-entry" role="listitem">
Rubin, Donald B. 1992. <span>“Meta-Analysis: Literature Synthesis or Effect-Size Surface Estimation?”</span> <em>Journal of Educational Statistics</em> 17 (4): 363–74. <a href="https://doi.org/10.3102/10769986017004363">https://doi.org/10.3102/10769986017004363</a>.
</div>
<div id="ref-wiernik2020" class="csl-entry" role="listitem">
Wiernik, Brenton M., and Jeffrey A. Dahlke. 2020. <span>“Obtaining Unbiased Results in Meta-Analysis: The Importance of Correcting for Statistical Artifacts.”</span> <em>Advances in Methods and Practices in Psychological Science</em> 3 (1): 94–123. <a href="https://doi.org/10.1177/2515245919885611">https://doi.org/10.1177/2515245919885611</a>.
</div>
<div id="ref-psych" class="csl-entry" role="listitem">
William Revelle. 2023. <em>Psych: Procedures for Psychological, Psychometric, and Personality Research</em>. Evanston, Illinois: Northwestern University. <a href="https://CRAN.R-project.org/package=psych">https://CRAN.R-project.org/package=psych</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./dedication.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Dedication</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./small_samples.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Small Samples</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>